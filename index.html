<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä»Šå¤©åƒä»€éº¼ï¼ŸV3</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* è«è˜­è¿ª V3 - æ›´æ¸…æ–°çš„é…è‰² */
            --bg: #F5F7F6;
            --card: #FFFFFF;
            --primary: #7A9CA5;      /* ç°è— */
            --secondary: #A5B59C;    /* æŠ¹èŒ¶ç¶  */
            --accent: #D49A89;       /* é«’ç²‰ç´… */
            --text: #555555;
            --shadow: 0 8px 30px rgba(122, 156, 165, 0.15);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { margin: 0; padding: 0; font-family: 'Noto Sans TC', sans-serif; background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* === é ‚éƒ¨é€²åº¦æ¢ === */
        .header { padding: 15px 20px; z-index: 10; display: flex; justify-content: space-between; align-items: center; }
        .app-logo { font-size: 18px; font-weight: bold; color: var(--primary); letter-spacing: 1px; }
        
        .wishlist-counter {
            background: white; padding: 6px 14px; border-radius: 20px;
            font-size: 14px; font-weight: bold; color: var(--accent);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); transition: transform 0.2s;
        }
        .wishlist-counter.bump { transform: scale(1.2); }

        /* === ä¸»èˆå° === */
        .main-stage {
            flex: 1; position: relative; width: 100%; max-width: 400px; margin: 0 auto;
            display: flex; flex-direction: column; justify-content: center; padding: 10px 20px;
        }

        /* ç€è¦½æ¨¡å¼ - å¡ç‰‡ */
        .browse-mode { display: flex; flex-direction: column; height: 100%; }
        
        .food-card {
            background: var(--card); border-radius: 24px; overflow: hidden;
            box-shadow: var(--shadow); flex: 1; display: flex; flex-direction: column;
            position: relative; animation: popIn 0.3s; margin-bottom: 20px;
        }
        .food-img-box { height: 50%; position: relative; }
        .food-img { width: 100%; height: 100%; object-fit: cover; }
        .price-badge {
            position: absolute; bottom: 10px; right: 10px;
            background: rgba(255,255,255,0.9); color: var(--text); padding: 4px 10px;
            border-radius: 20px; font-size: 12px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .food-content { padding: 20px; flex: 1; overflow-y: auto; }
        .food-title { font-size: 24px; font-weight: bold; margin-bottom: 5px; color: var(--text); }
        .food-desc { font-size: 14px; color: #888; line-height: 1.5; margin-bottom: 15px; }
        
        .tag-row { display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 15px; }
        .info-tag { background: #EDF2F4; padding: 4px 10px; border-radius: 8px; font-size: 12px; color: #666; }

        /* åº•éƒ¨æŒ‰éˆ• */
        .bottom-controls {
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px 30px;
        }
        .big-btn {
            width: 65px; height: 65px; border-radius: 50%; border: none;
            font-size: 24px; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.1s;
        }
        .big-btn:active { transform: scale(0.9); }
        .btn-pass { background: white; color: var(--gray); border: 1px solid #eee; }
        .btn-keep { background: var(--accent); color: white; width: 75px; height: 75px; font-size: 28px; box-shadow: 0 8px 20px rgba(214, 140, 140, 0.4); }

        /* === æ±ºé¸æ“‚å° (Shortlist Mode) === */
        .shortlist-mode { display: none; height: 100%; flex-direction: column; }
        .shortlist-mode.show { display: flex; animation: fadeIn 0.5s; }
        
        .mode-title { font-size: 22px; font-weight: bold; color: var(--primary); text-align: center; margin-bottom: 5px; }
        .mode-desc { text-align: center; color: #999; font-size: 13px; margin-bottom: 20px; }

        .pk-container { flex: 1; overflow-y: auto; padding-bottom: 20px; }
        
        .pk-card {
            background: white; border-radius: 16px; padding: 10px; margin-bottom: 15px;
            display: flex; align-items: center; gap: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            cursor: pointer; transition: all 0.2s; border: 2px solid transparent;
        }
        .pk-card:active { transform: scale(0.98); }
        .pk-card.selected { border-color: var(--primary); background: #F0F5F7; }
        
        .pk-img { width: 70px; height: 70px; border-radius: 12px; object-fit: cover; }
        .pk-info { flex: 1; }
        .pk-name { font-weight: bold; font-size: 16px; color: var(--text); }
        .pk-meta { font-size: 12px; color: #999; margin-top: 2px; }

        .final-actions { text-align: center; margin-top: auto; padding-bottom: 30px; }
        .btn-final {
            background: var(--primary); color: white; border: none; padding: 15px 40px;
            border-radius: 30px; font-size: 16px; font-weight: bold; width: 100%;
            box-shadow: 0 5px 15px rgba(122, 156, 165, 0.3);
        }
        .btn-random-pick {
            background: white; color: var(--secondary); border: 2px solid var(--secondary);
            margin-top: 10px;
        }

        /* æˆåŠŸç•«é¢ */
        .success-overlay {
            position: fixed; inset: 0; background: white; z-index: 100;
            display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 30px;
        }
        .success-overlay.show { display: flex; animation: fadeIn 0.5s; }
        .final-img { width: 160px; height: 160px; border-radius: 50%; object-fit: cover; margin-bottom: 25px; box-shadow: var(--shadow); border: 5px solid white; }
        
        /* å¿«é€Ÿç¯©é¸ä¸¸ */
        .quick-actions { margin-top: 10px; display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .quick-actions::-webkit-scrollbar { display: none; }
        .chip-btn { white-space: nowrap; padding: 6px 12px; border-radius: 15px; border: 1px solid #E0E0E0; background: white; color: #888; font-size: 12px; flex-shrink: 0; }

        /* Loading */
        .loading-screen { position: fixed; inset: 0; background: var(--bg); z-index: 200; display: flex; align-items: center; justify-content: center; transition: opacity 0.5s; }
        .loading-screen.hide { opacity: 0; pointer-events: none; }

        @keyframes popIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="loading" class="loading-screen">
        <i class="fas fa-utensils fa-spin" style="font-size:40px; color:var(--primary);"></i>
    </div>

    <div class="header">
        <div class="app-logo">WHAT TO EAT</div>
        <div id="wishCounter" class="wishlist-counter">â¤ï¸ 0 / 3</div>
    </div>

    <div class="main-stage">
        
        <div id="browseMode" class="browse-mode">
            <div id="cardContainer" class="food-card">
                <div class="food-img-box">
                    <img id="fImg" class="food-img" src="">
                    <span id="fPrice" class="price-badge">$$</span>
                </div>
                <div class="food-content">
                    <div id="fName" class="food-title">è¼‰å…¥ä¸­...</div>
                    <div class="tag-row" id="fTags"></div>
                    <div id="fDesc" class="food-desc"></div>
                    
                    <div style="font-size:12px; font-weight:bold; color:var(--primary); margin-bottom:5px;">éæ¿¾æ‰ï¼š</div>
                    <div class="quick-actions">
                        <div class="chip-btn" onclick="filterOut('cat')">ğŸš« é€™é¡å…ˆä¸è¦</div>
                        <div class="chip-btn" onclick="filterOut('heavy')">ğŸ¥¦ å¤ªæ²¹è†©</div>
                        <div class="chip-btn" onclick="filterOut('spicy')">ğŸŒ¶ï¸ ä¸åƒè¾£</div>
                        <div class="chip-btn" onclick="filterOut('expensive')">ğŸ’¸ å¤ªè²´</div>
                    </div>
                </div>
            </div>

            <div class="bottom-controls">
                <button class="big-btn btn-pass" onclick="nextCard()">
                    <i class="fas fa-times"></i>
                </button>
                <div style="font-size:12px; color:#999; text-align:center;">
                    å·¦é‚Šï¼šæ›ä¸€å¼µ<br>å³é‚Šï¼šåŠ å…¥å€™é¸
                </div>
                <button class="big-btn btn-keep" onclick="addToWishlist()">
                    <i class="fas fa-heart"></i>
                </button>
            </div>
        </div>

        <div id="shortlistMode" class="shortlist-mode">
            <div class="mode-title">æ±ºé¸æ“‚å° ğŸ‘‘</div>
            <div class="mode-desc">é€™ 3 å®¶ä½ éƒ½æƒ³åƒï¼Œé¸ä¸€å®¶æœ€æƒ³å»çš„ï¼</div>
            
            <div id="pkList" class="pk-container">
                </div>

            <div class="final-actions">
                <button class="btn-final btn-random-pick" onclick="randomPickFinal()">
                    ğŸ² æœ‰é¸æ“‡éšœç¤™ï¼Ÿå¹«æˆ‘é¸ï¼
                </button>
            </div>
        </div>

    </div>

    <div id="successOverlay" class="success-overlay">
        <img id="finalImg" class="final-img">
        <h2 style="color:var(--primary); margin-bottom:5px;">ä»Šæ™šå°±åƒé€™å€‹ï¼</h2>
        <h1 id="finalName" style="font-size:32px; margin:0 0 20px 0;"></h1>
        <p style="color:#666;">åˆ¥å†çŒ¶è±«äº†ï¼Œç¾åœ¨å°±å‡ºç™¼ï¼</p>
        
        <a id="mapLink" href="#" target="_blank" class="btn-final" style="display:flex; align-items:center; justify-content:center; text-decoration:none;">
            <i class="fas fa-location-arrow" style="margin-right:10px;"></i> Google Maps å°èˆª
        </a>
        <div style="margin-top:30px; color:#999; text-decoration:underline; cursor:pointer;" onclick="location.reload()">é‡ç©ä¸€æ¬¡</div>
    </div>

    <script>
        // === è³‡æ–™åº« (50+ é¸é …ï¼Œå®Œæ•´ V2 æ ¼å¼) ===
        const database = [
            // --- å°å¼ & å°åƒ ---
            { name: "æ»·è‚‰é£¯", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1627207644063-267926715201?w=600", desc: "åœ‹æ°‘ç¾é£Ÿï¼Œè‚¥ç˜¦æ»·æ±æ·‹åœ¨ç™½é£¯ä¸Šï¼Œç°¡å–®å»éŠ·é­‚ã€‚", shops: ["é¬é¬šå¼µ", "é‡‘å³°", "çŸ®ä»”è²¡", "å®¶è£¡é™„è¿‘é‚£å®¶"] },
            { name: "ç´…ç‡’ç‰›è‚‰éºµ", cat: "å°å¼", price: 2, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1596458397260-255551c09534?w=600", desc: "æ¿ƒéƒæ¹¯é ­é…ä¸Šå¤§å¡Šç‰›è‚‰ï¼Œå°ç£ä¹‹å…‰ã€‚", shops: ["æ—æ±èŠ³", "æ®µç´”è²", "ä¸‰å•†å·§ç¦", "æ°¸åº·ç‰›è‚‰éºµ"] },
            { name: "ä¹¾éºµ + æ»·å‘³", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1552611052-33e04de081de?w=600", desc: "ç°¡å–®çš„éº»é†¬æˆ–ç‚¸é†¬éºµï¼Œé…é»è±†å¹²æµ·å¸¶ã€‚", shops: ["å··å£éºµåº—", "ç¦å·ä¹¾éºµ", "å—æ©Ÿå ´"] },
            { name: "å¤§é›æ’ + çå¥¶", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?w=600", desc: "ç‚¸å¾—é‡‘é»ƒé…¥è„†ï¼Œç½ªæƒ¡æ„Ÿèˆ‡å¹¸ç¦æ„ŸåŒæ™‚çˆ†è¡¨ã€‚", shops: ["è±ªå¤§å¤§", "æ´¾å…‹", "å¤©ä½¿é›æ’", "è‰‹èˆº"] },
            { name: "è„†çš®è‡­è±†è…", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1583069358212-04e8d89ce58a?w=600", desc: "å¤–é…¥å…§å«©ï¼Œå¡å…¥æ³¡èœä¸€å£å’¬ä¸‹ï¼Œçµ•é…ã€‚", shops: ["é˜¿å¤§", "é‡Œé•·ä¼¯", "å¸«å¤§å¤œå¸‚"] },
            { name: "èšµä»”ç…", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1600093463592-8e36ae95ef56?w=600", desc: "Qå½ˆç²‰æ¼¿åŒ…è£¹é®®èšµèˆ‡å°ç™½èœï¼Œæ·‹ä¸Šç”œè¾£é†¬ã€‚", shops: ["å¯§å¤å¤œå¸‚", "å£«æ—å¤œå¸‚", "è³´é›è›‹"] },
            { name: "æ¸…ç²¥å°èœ", cat: "å°å¼", price: 2, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1516684732738-16fa2021c179?w=600", desc: "æ¸…æ·¡ç™½ç²¥é…ä¸Šå¤šæ¨£å°èœï¼Œæš–èƒƒåˆè±å¯Œã€‚", shops: ["å°æå­", "ç„¡åç²¥å“", "å¾©èˆˆå—è·¯"] },
            { name: "å°å¼ç†±ç‚’", cat: "å°å¼", price: 2, heavy: true, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1551249721-a4b51cc13075?w=600", desc: "å®®ä¿é›ä¸ã€é³³æ¢¨è¦çƒï¼Œé…å•¤é…’æœ€å°å‘³ã€‚", shops: ["å…ˆé€²æµ·ç”¢", "è‡¨æ´‹æ¸¯", "é•·å®‰æ±è·¯"] },
            { name: "ç«é›è‚‰é£¯", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1606525437679-037aca74a3e9?w=600", desc: "é®®å«©ç«é›è‚‰çµ²æ·‹ä¸Šé›æ²¹ï¼Œé¦™æ°£å››æº¢ã€‚", shops: ["å™´æ°´", "åŠ‰é‡Œé•·", "å˜‰ç¾©é›è‚‰é£¯"] },
            { name: "æº«å·å¤§é¤›é£©", cat: "å°å¼", price: 1, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1596458397223-93c66f25459b?w=600", desc: "çš®è–„é¤¡å¤§ï¼ŒåŠ é»ç´…æ²¹æŠ„æ‰‹æ›´éç™®ã€‚", shops: ["è€è™é†¬", "æ¥Šè¨˜", "èŠ±è“®æ‰é£Ÿ"] },
            { name: "æ¶¼éºµ + å‘³å™Œæ¹¯", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1594975519808-8df04405362a?w=600", desc: "éº»é†¬é¦™æ°£é…ä¸Šå°é»ƒç“œï¼Œå¤å¤©å¿…åƒçµ„åˆã€‚", shops: ["é™³å®¶", "ç¦å¾·", "åŠ‰åª½åª½"] },
            { name: "æ½¤é¤…æ²", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1609180746973-20739c381c8b?w=600", desc: "æ»¿æ»¿è”¬èœèˆ‡èŠ±ç”Ÿç²‰ï¼Œæ¸…çˆ½åˆæœ‰é£½è¶³æ„Ÿã€‚", shops: ["é˜¿å¼˜", "ä¸­è¯ä¸€é¤…", "å¤œå¸‚æ”¤ä½"] },
            { name: "éº»è¾£é´¨è¡€", cat: "å°å¼", price: 1, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1541280910158-c4e34faf2c00?w=600", desc: "æ»‘å«©é´¨è¡€å¸æ»¿è¾£æ¹¯ï¼Œå…¥å‘³åˆé–‹èƒƒã€‚", shops: ["è©¹è¨˜", "å¤ªå’Œæ®¿", "å¤œå¸‚éº»è¾£"] },
            { name: "æ°´é¤ƒ / é‹è²¼", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1534422298391-e4f8c172dddb?w=600", desc: "çš®è–„é¤¡å¤šï¼Œæ²¾é†¬æ²¹é†‹æœ€å°å‘³ã€‚", shops: ["å…«æ–¹é›²é›†", "å››æµ·éŠé¾", "äº”èŠ±é¦¬"] },

            // --- æ—¥å¼æ–™ç† ---
            { name: "æ—¥å¼æ‹‰éºµ", cat: "æ—¥å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=600", desc: "æ¿ƒéƒæ¹¯é ­é…ä¸Šå‹é“éºµæ¢ï¼Œæš–å¿ƒé¦–é¸ã€‚", shops: ["ä¸€è˜­", "å±¯äº¬", "é¬¼é‡‘æ£’", "é³¥äºº"] },
            { name: "è¿´è½‰å£½å¸", cat: "æ—¥å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=600", desc: "æ¸…çˆ½ç„¡è² æ“”ï¼Œæƒ³åƒå¤šå°‘æ‹¿å¤šå°‘ã€‚", shops: ["è—å£½å¸", "å£½å¸éƒ", "çˆ­é®®", "Hama"] },
            { name: "ç‚¸è±¬æ’å®šé£Ÿ", cat: "æ—¥å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1616428467478-43d969248232?w=600", desc: "å¤–é…¥å…§å«©çš„åšåˆ‡è±¬æ’ï¼Œé…ä¸Šé«˜éº—èœçµ²ã€‚", shops: ["å‹åšæ®¿", "æå­", "ç¦å‹äº­", "å“ç”°"] },
            { name: "ç‰›ä¸¼", cat: "æ—¥å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1554502078-ef0fc409efce?w=600", desc: "å¤§ç¢—è‚‰ç‰‡é‹ªåœ¨é£¯ä¸Šï¼Œå¿«é€Ÿæ»¿è¶³ã€‚", shops: ["å‰é‡å®¶", "Sukiya", "æ¾å±‹"] },
            { name: "æ—¥å¼å’–å“©", cat: "æ—¥å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1604152135912-04a022e23696?w=600", desc: "æ¿ƒéƒç”˜ç”œçš„æ—¥å¼å’–å“©ï¼Œå¤§äººå°å­©éƒ½æ„›ã€‚", shops: ["CoCoå£¹ç•ªå±‹", "é€šåºµ", "ä½è—¤"] },
            { name: "çƒé¾éºµ", cat: "æ—¥å¼", price: 1, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1612929633738-8fe44f7ec841?w=600", desc: "Qå½ˆæ»‘é †çš„éºµæ¢ï¼Œé…ä¸Šç‚¸ç‰©å¤©å©¦ç¾…ã€‚", shops: ["ä¸¸äº€è£½éºµ", "ç¨»ç¦¾", "åœŸä¸‰å¯’å…­"] },
            { name: "æ—¥å¼ç‡’è‚‰", cat: "æ—¥å¼", price: 3, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1592685829283-7c0bb77df3c9?w=600", desc: "äº«å—è‡ªå·±å‹•æ‰‹çƒ¤è‚‰çš„æ¨‚è¶£ï¼Œè‚‰é£Ÿè€…å¤©å ‚ã€‚", shops: ["ä¹¾æ¯", "è€ä¹¾æ¯", "ç‰›è§’", "èŒ¶å…­"] },
            { name: "å±…é…’å±‹ä¸²ç‡’", cat: "æ—¥å¼", price: 3, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1534604973900-c43ab4c2e0ab?w=600", desc: "ä¸‹ç­å¾Œçš„å°é…Œæ™‚å…‰ï¼Œç‚­ç«é¦™æ°£è¿·äººã€‚", shops: ["å³ç•™æ‰‹", "å¤§æ‘æ­¦", "æ¿€å®‰"] },
            { name: "ç”Ÿé­šç‰‡ä¸¼é£¯", cat: "æ—¥å¼", price: 3, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1562436260-8c9216eeb703?w=600", desc: "æ»¿æ»¿çš„æ–°é®®æµ·é®®é‹ªåœ¨é†‹é£¯ä¸Šï¼Œè±ªè¯äº«å—ã€‚", shops: ["çè‘—çˆ¹", "é‡‘æ³°", "ç¯‰åœ°"] },
            { name: "å¤©å©¦ç¾…ä¸¼", cat: "æ—¥å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1560155016-16e6c1cc3e53?w=600", desc: "è±ªé‚çš„ç‚¸è¦èˆ‡è”¬èœï¼Œæ·‹ä¸Šé¹¹ç”œé†¬æ±ã€‚", shops: ["é‡‘å­åŠä¹‹åŠ©", "å¤©å‰å±‹"] },
            { name: "å¤§é˜ªç‡’", cat: "æ—¥å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1563489851-9040854d9203?w=600", desc: "æ»¿æ»¿çš„é«˜éº—èœèˆ‡é…æ–™ï¼Œæ·‹ä¸Šç¾ä¹ƒæ»‹ã€‚", shops: ["åƒæˆ¿", "éµåŒ ", "é¶´æ©‹é¢¨æœˆ"] },

            // --- è¥¿å¼ & é€Ÿé£Ÿ ---
            { name: "éº¥ç•¶å‹", cat: "é€Ÿé£Ÿ", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5?w=600", desc: "ç†Ÿæ‚‰çš„å‘³é“ï¼Œè–¯æ¢æ˜¯æœ¬é«”ã€‚", shops: ["éº¥ç•¶å‹", "è‚¯å¾·åŸº", "æ¼¢å ¡ç‹"] },
            { name: "è‚¯å¾·åŸº KFC", cat: "é€Ÿé£Ÿ", price: 1, heavy: true, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?w=600", desc: "æƒ³åƒç‚¸é›å’Œè›‹å¡”çš„æ™‚å€™ï¼Œé€™æ˜¯ä¸äºŒä¹‹é¸ã€‚", shops: ["è‚¯å¾·åŸº", "æ‹¿å¡é‡Œ", "èƒ–è€çˆ¹"] },
            { name: "æŠ«è–© Pizza", cat: "è¥¿å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1513104890138-7c749659a591?w=600", desc: "ç‰½çµ²çš„èµ·å¸èˆ‡é…¥è„†é¤…çš®ï¼Œèšé¤é¦–é¸ã€‚", shops: ["å¿…å‹å®¢", "é”ç¾æ¨‚", "è˜‡é˜¿å§¨"] },
            { name: "Subway", cat: "è¥¿å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1509722747741-092075b55909?w=600", desc: "æ»¿æ»¿è”¬èœçš„æ½›è‰‡å ¡ï¼Œå¥åº·åˆæ–¹ä¾¿ã€‚", shops: ["Subway", "Quiznos"] },
            { name: "ç¾©å¤§åˆ©éºµ", cat: "è¥¿å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1473093295043-cdd812d0e601?w=600", desc: "å¥¶æ²¹ã€é’é†¬æˆ–ç•ªèŒ„ï¼Œå£å‘³å¤šè®Šã€‚", shops: ["è–„å¤šç¾©", "JAPOLI", "è–©è‰äº"] },
            { name: "ç¾å¼æ—©åˆé¤", cat: "è¥¿å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1533089862017-5614ecb3f2f2?w=600", desc: "ç­å°¼è¿ªå…‹è›‹é…å’–å•¡ï¼Œæ‚ é–’çš„ä¸€é¤ã€‚", shops: ["Second Floor", "The Diner", "Q Burger"] },
            { name: "ç‰›æ’é¤¨", cat: "è¥¿å¼", price: 3, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1600891964092-4316c288032e?w=600", desc: "æ…¶ç¥ç¯€æ—¥æˆ–çŠ’è³è‡ªå·±çš„å¥½é¸æ“‡ã€‚", shops: ["ç‹å“", "èŒ¹çµ²è‘µ", "å­«æ±å¯¶", "æ•™çˆ¶"] },
            { name: "ç¾å¼æ¼¢å ¡", cat: "è¥¿å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=600", desc: "æ‰‹å·¥è‚‰æ’å¤šæ±åšå¯¦ï¼Œå¤§å£å’¬ä¸‹è¶…æ»¿è¶³ã€‚", shops: ["KUA`AINA", "GB", "Bravo"] },
            { name: "å‡±è–©æ²™æ‹‰", cat: "è¥¿å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600", desc: "å¤§é‡ç”Ÿèœé…ä¸Šé›è‚‰èˆ‡éºµåŒ…ä¸ï¼Œè¼•ç›ˆä¸€é¤ã€‚", shops: ["Costco", "æ²™æ‹‰å°ˆè³£åº—", "è¶…å•†"] },
            { name: "ç¾©å¼ç‡‰é£¯", cat: "è¥¿å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1476124369491-e7addf5db371?w=600", desc: "å¸æ»¿é«˜æ¹¯ç²¾è¯çš„ç±³ç²’ï¼Œæ¿ƒéƒåˆé£½è¶³ã€‚", shops: ["é»‘ç±³", "éš¨æ„é³¥åœ°æ–¹"] },

            // --- ç«é‹ & æ¹¯é¡ ---
            { name: "éº»è¾£ç«é‹", cat: "ç«é‹", price: 3, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1582236357997-6a422a57ae22?w=600", desc: "é¦™è¾£éç™®ï¼Œé©åˆé‡å£å‘³èˆ‡èšé¤ã€‚", shops: ["æµ·åº•æ’ˆ", "è©¹è¨˜", "é¦¬è¾£", "è€å››å·"] },
            { name: "å€‹äººå°ç«é‹", cat: "ç«é‹", price: 1, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1547592166-23acbe34071b?w=600", desc: "ä¸€å€‹äººä¹Ÿèƒ½æš–æš–åƒé‹ï¼ŒCPå€¼é«˜ã€‚", shops: ["ä¸‰åª½", "å¤§å‘¼éç™®", "çŸ³äºŒé‹", "ç¯‰é–“"] },
            { name: "å£½å–œç‡’", cat: "æ—¥å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1584213123849-5f1118335914?w=600", desc: "é¹¹ç”œé†¬æ±æ¶®è‚‰ç‰‡ï¼Œæ²¾è›‹æ¶²è¶…æ»‘é †ã€‚", shops: ["MOMO Paradise", "ä¸€ç•ªåœ°", "æ½®è‚‰"] },
            { name: "è–‘æ¯é´¨/ç¾Šè‚‰çˆ", cat: "å°å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1616428467478-43d969248232?w=600", desc: "å†¬å¤©é€²è£œé¦–é¸ï¼Œç‚­ç«åŠ ç†±æ›´æœ‰å‘³ã€‚", shops: ["éœ¸å‘³", "ä¸‹æ¸¯", "é›…é¦™"] },

            // --- ç•°åœ‹ & å…¶ä»– ---
            { name: "éŸ“å¼ç‚¸é›", cat: "éŸ“å¼", price: 2, heavy: true, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?w=600", desc: "è£¹æ»¿ç”œè¾£é†¬æ±çš„é…¥è„†ç‚¸é›ï¼Œé…é†ƒè˜¿è””ã€‚", shops: ["èµ·å®¶é›", "bb.q", "Nene"] },
            { name: "éŸ“å¼æ³¡èœé‹", cat: "éŸ“å¼", price: 2, heavy: false, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1596458397260-255551c09534?w=600", desc: "é…¸è¾£é–‹èƒƒï¼Œé…ä¸Šä¸€ç¢—ç™½é£¯å‰›å‰›å¥½ã€‚", shops: ["æ¶“è±†è…", "åŒ—æ‘", "ä¸‰å…ƒ"] },
            { name: "çŸ³é‹æ‹Œé£¯", cat: "éŸ“å¼", price: 2, heavy: false, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=600", desc: "é…¥è„†é‹å·´é…ä¸Šè±å¯Œé…èœï¼Œæ‹Œåœ¨ä¸€èµ·åƒã€‚", shops: ["éŸ“é¶´äº­", "é«˜éº—åœ’"] },
            { name: "æ³°å¼æ–™ç†", cat: "æ³°å¼", price: 2, heavy: false, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1559314809-0d155014e29e?w=600", desc: "é…¸è¾£é–‹èƒƒï¼Œæœˆäº®è¦é¤…å¿…é»ã€‚", shops: ["ç“¦åŸ", "NARA", "æ³°å¸‚å ´"] },
            { name: "è¶Šå—æ²³ç²‰", cat: "è¶Šå¼", price: 1, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1582878826629-29b7ad1cdc43?w=600", desc: "æ¸…ç”œæ¹¯é ­é…ä¸Šæ»‘é †æ²³ç²‰ï¼Œæ¸…çˆ½é¸æ“‡ã€‚", shops: ["èª è¨˜", "L.A PHO", "CYCLO"] },
            { name: "å°ç± åŒ…", cat: "ä¸­å¼", price: 3, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1563245372-f21724e3856d?w=600", desc: "çš®è–„æ±å¤šï¼Œæ­é…è–‘çµ²é†‹ä¸€å£å’¬ä¸‹ã€‚", shops: ["é¼æ³°è±", "é»æ°´æ¨“", "æ­å·å°ç± æ¹¯åŒ…"] },
            { name: "æ¸¯å¼é£²èŒ¶", cat: "æ¸¯å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1541696490865-e6f720e9c195?w=600", desc: "ç‡’è³£ã€è¦é¤ƒã€å‰ç‡’åŒ…ï¼Œæ¨£æ¨£éƒ½ä¾†ä¸€é»ã€‚", shops: ["é»é»å¿ƒ", "æ·»å¥½é‹", "äº¬æ˜Ÿ"] },
            { name: "ç‡’è‡˜ä¾¿ç•¶", cat: "æ¸¯å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1552611052-33e04de081de?w=600", desc: "æ²¹é›ã€ç‡’é´¨ã€å‰ç‡’ï¼Œé…ä¸Šè”¥æ²¹æœ€ä¸‹é£¯ã€‚", shops: ["é³³åŸ", "é¦™æ¸¯å®¶é´»", "å¥½å‘³"] },
            { name: "å¥åº·é¤ç›’", cat: "å¥åº·", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600", desc: "æ°´ç…®ä½å¡ï¼Œå¢è‚Œæ¸›è„‚é¦–é¸ã€‚", shops: ["èƒ½é‡å°å§", "å¥åº·æ°´ç…®", "Just Kitchen"] },
            { name: "å°åº¦å’–å“©", cat: "ç•°åœ‹", price: 2, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1604152135912-04a022e23696?w=600", desc: "é¦™æ–™å‘³æ¿ƒéƒï¼Œé…çƒ¤é¤…ä¸€çµ•ã€‚", shops: ["Saffron", "é¦¬å‹å‹", "Taj"] },
            { name: "å¤å¨å¤·æ‹Œé£¯", cat: "ç¾å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=600", desc: "ç”Ÿé­šç‰‡é…å¤§é‡è”¬èœï¼Œæ¸…çˆ½ç„¡è² æ“”ã€‚", shops: ["HALOA", "PokÃ© Shop", "JJ's"] }
        ];

        // === é‚è¼¯å€ ===
        let pool = [...database];
        let currentItem = null;
        let wishlist = []; // å€™é¸æ¸…å–®
        const MAX_WISH = 3; // é›†æ»¿3å€‹é€²å…¥æ±ºé¸

        // åˆå§‹åŒ–
        setTimeout(() => {
            document.getElementById('loading').classList.add('hide');
            renderCard();
        }, 1000);

        function renderCard() {
            if (pool.length === 0) {
                alert("é¸é …éƒ½çœ‹å®Œäº†ï¼é‡æ–°æ´—ç‰Œ...");
                pool = [...database];
            }

            // éš¨æ©ŸæŠ½ä¸€å¼µ
            const idx = Math.floor(Math.random() * pool.length);
            currentItem = pool[idx];

            // å¡«å…¥è³‡æ–™
            document.getElementById('fImg').src = currentItem.img;
            document.getElementById('fName').innerText = currentItem.name;
            document.getElementById('fDesc').innerText = currentItem.desc;
            
            // æ¨™ç±¤
            let tagsHtml = `<span class="info-tag">${currentItem.cat}</span>`;
            if(currentItem.heavy) tagsHtml += `<span class="info-tag">é£½è¶³</span>`;
            if(!currentItem.heavy) tagsHtml += `<span class="info-tag">è¼•é£Ÿ</span>`;
            if(currentItem.soup) tagsHtml += `<span class="info-tag">æœ‰æ¹¯</span>`;
            if(currentItem.spicy) tagsHtml += `<span class="info-tag">è¾£</span>`;
            document.getElementById('fTags').innerHTML = tagsHtml;

            // åƒ¹æ ¼
            let pStr = "";
            for(let i=0; i<3; i++) pStr += i < currentItem.price ? "â˜…" : "â˜†";
            document.getElementById('fPrice').innerText = pStr;

            // è§¸ç™¼å‹•ç•«
            const card = document.getElementById('cardContainer');
            card.style.animation = 'none';
            card.offsetHeight; 
            card.style.animation = 'popIn 0.3s';
        }

        // æ›ä¸€å¼µ (ä¸å–œæ­¡)
        function nextCard() {
            renderCard();
        }

        // åŠ å…¥å€™é¸ (å–œæ­¡)
        function addToWishlist() {
            // é¿å…é‡è¤‡
            if (wishlist.some(i => i.name === currentItem.name)) {
                alert("å·²ç¶“åœ¨æ¸…å–®è£¡å›‰ï¼");
                nextCard();
                return;
            }

            wishlist.push(currentItem);
            updateCounter();

            // å¾ pool ç§»é™¤ï¼Œé¿å…é‡è¤‡æŠ½åˆ°
            pool = pool.filter(i => i.name !== currentItem.name);

            // æª¢æŸ¥æ˜¯å¦é›†æ»¿
            if (wishlist.length >= MAX_WISH) {
                showShortlist();
            } else {
                nextCard();
            }
        }

        function updateCounter() {
            const counter = document.getElementById('wishCounter');
            counter.innerText = `â¤ï¸ ${wishlist.length} / ${MAX_WISH}`;
            counter.classList.add('bump');
            setTimeout(() => counter.classList.remove('bump'), 200);
        }

        // éæ¿¾å™¨
        function filterOut(reason) {
            // å¾æ± ä¸­ç§»é™¤ç•¶å‰é€™å€‹
            pool = pool.filter(i => i.name !== currentItem.name);

            if (reason === 'cat') {
                pool = pool.filter(i => i.cat !== currentItem.cat);
            } else if (reason === 'heavy') {
                pool = pool.filter(i => !i.heavy);
            } else if (reason === 'spicy') {
                pool = pool.filter(i => !i.spicy);
            } else if (reason === 'expensive') {
                pool = pool.filter(i => i.price < currentItem.price);
            }
            renderCard();
        }

        // === æ±ºé¸æ¨¡å¼ ===
        function showShortlist() {
            document.getElementById('browseMode').style.display = 'none';
            document.getElementById('shortlistMode').classList.add('show');
            
            const container = document.getElementById('pkList');
            container.innerHTML = wishlist.map((item, idx) => `
                <div class="pk-card" onclick="finalDecide(${idx})">
                    <img src="${item.img}" class="pk-img">
                    <div class="pk-info">
                        <div class="pk-name">${item.name}</div>
                        <div class="pk-meta">${item.desc}</div>
                    </div>
                    <i class="fas fa-chevron-right" style="color:#ddd;"></i>
                </div>
            `).join('');
        }

        // æœ€çµ‚é¸æ“‡ (æ‰‹å‹•é»é¸)
        function finalDecide(idx) {
            showSuccess(wishlist[idx]);
        }

        // å¹«æˆ‘é¸ (éš¨æ©Ÿ)
        function randomPickFinal() {
            const idx = Math.floor(Math.random() * wishlist.length);
            // ç¨å¾®è½‰ä¸€ä¸‹æ•ˆæœ
            let count = 0;
            const interval = setInterval(() => {
                const cards = document.querySelectorAll('.pk-card');
                cards.forEach(c => c.classList.remove('selected'));
                cards[count % cards.length].classList.add('selected');
                count++;
                if (count > 10) {
                    clearInterval(interval);
                    setTimeout(() => showSuccess(wishlist[idx]), 500);
                }
            }, 100);
        }

        function showSuccess(item) {
            document.getElementById('successOverlay').classList.add('show');
            document.getElementById('finalImg').src = item.img;
            document.getElementById('finalName').innerText = item.name;
            
            const q = encodeURIComponent(item.name + " é™„è¿‘");
            document.getElementById('mapLink').href = `https://www.google.com/maps/search/?api=1\&query=Naples+Airport{q}`;
        }

    </script>
</body>
</html>