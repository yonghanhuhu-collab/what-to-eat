<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä»Šå¤©åƒä»€éº¼ï¼ŸV2</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* è«è˜­è¿ªé…è‰² V2 (æ›´æ²ˆç©©) */
            --bg: #F2F4F3;
            --card: #FFFFFF;
            --primary: #6B8E9B;      /* ç°è— */
            --secondary: #8E9B6B;    /* æ©„æ¬–ç¶  */
            --accent: #D68C8C;       /* è±†æ²™ç´… */
            --text: #464646;
            --gray: #9E9E9E;
            --shadow: 0 8px 25px rgba(107, 142, 155, 0.15);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { margin: 0; padding: 0; font-family: 'Noto Sans TC', sans-serif; background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* === 1. é–‹å ´å•å· (Onboarding) === */
        .onboarding-layer {
            position: fixed; inset: 0; background: var(--bg); z-index: 200;
            padding: 30px; display: flex; flex-direction: column; justify-content: center;
            transition: transform 0.4s ease;
        }
        .onboarding-layer.hidden { transform: translateY(-100%); }
        
        .q-step { display: none; animation: fadeIn 0.4s; }
        .q-step.active { display: block; }
        
        .q-title { font-size: 24px; font-weight: bold; margin-bottom: 30px; color: var(--primary); text-align: center; }
        .option-grid { display: grid; gap: 15px; }
        .option-btn {
            padding: 20px; background: white; border: 2px solid transparent;
            border-radius: 16px; font-size: 18px; font-weight: 500; text-align: center;
            box-shadow: var(--shadow); cursor: pointer; transition: all 0.2s;
        }
        .option-btn:active { transform: scale(0.98); background: #f0f0f0; }
        .option-btn.selected { border-color: var(--primary); background: #EBF2F5; color: var(--primary); }

        /* === 2. ä¸»ç•«é¢ === */
        .header { padding: 15px; text-align: center; z-index: 10; height: 60px; }
        .app-logo { font-size: 18px; font-weight: bold; color: var(--primary); letter-spacing: 2px; }

        .main-stage {
            flex: 1; position: relative; width: 100%; max-width: 400px; margin: 0 auto;
            display: flex; flex-direction: column; justify-content: center; padding: 10px 20px;
        }

        /* å¡ç‰‡è¨­è¨ˆ */
        .food-card {
            background: var(--card); border-radius: 24px; overflow: hidden;
            box-shadow: var(--shadow); height: 65vh; display: flex; flex-direction: column;
            position: relative; animation: popIn 0.3s;
        }
        .food-img-box { height: 45%; position: relative; }
        .food-img { width: 100%; height: 100%; object-fit: cover; }
        .price-badge {
            position: absolute; bottom: 10px; right: 10px;
            background: rgba(0,0,0,0.6); color: white; padding: 4px 10px;
            border-radius: 20px; font-size: 12px; backdrop-filter: blur(4px);
        }

        .food-content { padding: 20px; flex: 1; overflow-y: auto; }
        .food-title { font-size: 26px; font-weight: bold; margin-bottom: 5px; color: var(--text); }
        .food-desc { font-size: 14px; color: #666; line-height: 1.5; margin-bottom: 15px; }
        
        .section-title { font-size: 12px; font-weight: bold; color: var(--primary); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }
        .rec-shops { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px; }
        .shop-tag { background: #F0F4F5; padding: 6px 12px; border-radius: 8px; font-size: 13px; color: #555; }

        /* === 3. å¿«é€Ÿç¯©é¸ä¸¸ (Quick Filters) === */
        .quick-actions {
            margin-top: 15px; display: flex; gap: 8px; overflow-x: auto; 
            padding-bottom: 5px; scrollbar-width: none;
        }
        .quick-actions::-webkit-scrollbar { display: none; }
        
        .chip-btn {
            white-space: nowrap; padding: 8px 16px; border-radius: 20px;
            border: 1px solid #E0E0E0; background: white; color: #888;
            font-size: 13px; flex-shrink: 0; transition: all 0.2s;
        }
        .chip-btn:active { background: var(--accent); color: white; border-color: var(--accent); }

        /* === 4. åº•éƒ¨æŒ‰éˆ• === */
        .bottom-controls {
            padding: 20px 30px 40px; display: flex; justify-content: space-between; align-items: center;
            width: 100%; max-width: 400px; margin: 0 auto;
        }
        .big-btn {
            width: 65px; height: 65px; border-radius: 50%; border: none;
            font-size: 24px; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.1s;
        }
        .big-btn:active { transform: scale(0.9); }
        .btn-pass { background: white; color: var(--accent); border: 2px solid #FFF0F0; }
        .btn-like { background: var(--primary); color: white; width: 75px; height: 75px; font-size: 30px; box-shadow: 0 8px 20px rgba(107, 142, 155, 0.4); }

        /* æˆåŠŸç•«é¢ */
        .success-overlay {
            position: fixed; inset: 0; background: white; z-index: 100;
            display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 30px;
        }
        .success-overlay.show { display: flex; animation: fadeIn 0.5s; }
        .final-img { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin-bottom: 20px; box-shadow: var(--shadow); }
        .map-btn {
            margin-top: 30px; background: var(--primary); color: white; padding: 15px 40px;
            border-radius: 30px; text-decoration: none; font-weight: bold; box-shadow: var(--shadow);
        }

        /* ç‹€æ…‹æç¤º */
        .toast {
            position: absolute; top: 70px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.7); color: white; padding: 8px 16px;
            border-radius: 20px; font-size: 13px; opacity: 0; pointer-events: none; transition: opacity 0.3s; z-index: 50;
        }

        @keyframes popIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="toast" class="toast">ç¯©é¸æ¢ä»¶å·²æ›´æ–°</div>

    <div id="onboarding" class="onboarding-layer">
        <div class="q-step active" id="step1">
            <div class="q-title">ä»Šå¤©æƒ³åƒ...</div>
            <div class="option-grid">
                <div class="option-btn" onclick="nextStep(1, 'price', 1)">ğŸ’° ä¾¿å®œç°¡å–®åƒ</div>
                <div class="option-btn" onclick="nextStep(1, 'price', 2)">ğŸ’µ ä¸€èˆ¬èšé¤åƒ¹ä½</div>
                <div class="option-btn" onclick="nextStep(1, 'price', 3)">ğŸ’ è±ªè¯å¤§é¤</div>
                <div class="option-btn" onclick="nextStep(1, 'price', 0)">ğŸ¤· æ²’å·®ï¼Œçœ‹æ„Ÿè¦º</div>
            </div>
        </div>
        <div class="q-step" id="step2">
            <div class="q-title">ç¾åœ¨é¤“å—ï¼Ÿ</div>
            <div class="option-grid">
                <div class="option-btn" onclick="nextStep(2, 'heavy', false)">ğŸ¥— ä¸å¤ªé¤“ï¼Œè¼•é£Ÿå°±å¥½</div>
                <div class="option-btn" onclick="nextStep(2, 'heavy', true)">ğŸ– è¶…é¤“ï¼Œæˆ‘è¦åƒé£½</div>
                <div class="option-btn" onclick="nextStep(2, 'heavy', null)">ğŸ¤· éƒ½å¯ä»¥</div>
            </div>
        </div>
        <div class="q-step" id="step3">
            <div class="q-title">å¤©æ°£/å¿ƒæƒ…å¦‚ä½•ï¼Ÿ</div>
            <div class="option-grid">
                <div class="option-btn" onclick="startGame('soup')">ğŸ¥£ æƒ³å–ç†±æ¹¯</div>
                <div class="option-btn" onclick="startGame('dry')">ğŸ¥¢ æƒ³åƒä¹¾çš„</div>
                <div class="option-btn" onclick="startGame('spicy')">ğŸŒ¶ï¸ æƒ³åƒè¾£ï¼</div>
                <div class="option-btn" onclick="startGame('all')">ğŸŒˆ æ²’æƒ³æ³•ï¼Œçµ¦æˆ‘é©šå–œ</div>
            </div>
        </div>
    </div>

    <div class="header">
        <div class="app-logo">WHAT TO EAT</div>
    </div>

    <div class="main-stage">
        <div id="cardContainer" class="food-card">
            <div class="food-img-box">
                <img id="fImg" class="food-img" src="">
                <span id="fPrice" class="price-badge">$$</span>
            </div>
            <div class="food-content">
                <div id="fName" class="food-title">è¼‰å…¥ä¸­...</div>
                <div id="fDesc" class="food-desc"></div>
                
                <div class="section-title">âœ¨ ååº— / å¸¸è¦‹é¸æ“‡</div>
                <div id="fShops" class="rec-shops"></div>

                <div class="section-title" style="margin-top:10px;">ğŸ¤” ä¸æƒ³åƒé€™å€‹ï¼Ÿé»æ“Šéæ¿¾ï¼š</div>
                <div class="quick-actions">
                    <div class="chip-btn" onclick="filterOut('cat')">ğŸš« ä¸æƒ³åƒé€™é¡</div>
                    <div class="chip-btn" onclick="filterOut('heavy')">ğŸ¥¦ å¤ªæ²¹è†©äº†</div>
                    <div class="chip-btn" onclick="filterOut('spicy')">ğŸŒ¶ï¸ ä¸åƒè¾£</div>
                    <div class="chip-btn" onclick="filterOut('expensive')">ğŸ’¸ å¤ªè²´äº†</div>
                    <div class="chip-btn" onclick="filterOut('rice')">ğŸš ä¸æƒ³åƒé£¯</div>
                    <div class="chip-btn" onclick="filterOut('noodle')">ğŸœ ä¸æƒ³åƒéºµ</div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-controls">
        <button class="big-btn btn-pass" onclick="nextCard()">
            <i class="fas fa-times"></i>
        </button>
        <div style="font-size:12px; color:#999;">æ›ä¸€å€‹ / å–œæ­¡</div>
        <button class="big-btn btn-like" onclick="confirmChoice()">
            <i class="fas fa-heart"></i>
        </button>
    </div>

    <div id="successOverlay" class="success-overlay">
        <img id="finalImg" class="final-img">
        <h2 style="color:var(--primary); margin-bottom:5px;">æ±ºå®šå°±æ˜¯å®ƒäº†ï¼</h2>
        <h1 id="finalName" style="font-size:32px; margin:0 0 20px 0;"></h1>
        <p style="color:#666;">åˆ¥å†çŒ¶è±«äº†ï¼Œç¾åœ¨å°±å‡ºç™¼ï¼</p>
        
        <a id="mapLink" href="#" target="_blank" class="map-btn">
            <i class="fas fa-location-arrow"></i> Google Maps æœå°‹
        </a>
        <div style="margin-top:30px; color:#999; text-decoration:underline;" onclick="location.reload()">é‡ç©ä¸€æ¬¡</div>
    </div>

    <script>
        // === è³‡æ–™åº« (50+ é¸é …ï¼Œå®Œæ•´ V2 æ ¼å¼) ===
        const database = [
            // --- å°å¼ & å°åƒ ---
            { name: "æ»·è‚‰é£¯", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1627207644063-267926715201?w=600", desc: "åœ‹æ°‘ç¾é£Ÿï¼Œè‚¥ç˜¦æ»·æ±æ·‹åœ¨ç™½é£¯ä¸Šï¼Œç°¡å–®å»éŠ·é­‚ã€‚", shops: ["é¬é¬šå¼µ", "é‡‘å³°", "çŸ®ä»”è²¡", "å®¶è£¡é™„è¿‘é‚£å®¶"] },
            { name: "ç´…ç‡’ç‰›è‚‰éºµ", cat: "å°å¼", price: 2, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1596458397260-255551c09534?w=600", desc: "æ¿ƒéƒæ¹¯é ­é…ä¸Šå¤§å¡Šç‰›è‚‰ï¼Œå°ç£ä¹‹å…‰ã€‚", shops: ["æ—æ±èŠ³", "æ®µç´”è²", "ä¸‰å•†å·§ç¦", "æ°¸åº·ç‰›è‚‰éºµ"] },
            { name: "ä¹¾éºµ + æ»·å‘³", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1552611052-33e04de081de?w=600", desc: "ç°¡å–®çš„éº»é†¬æˆ–ç‚¸é†¬éºµï¼Œé…é»è±†å¹²æµ·å¸¶ã€‚", shops: ["å··å£éºµåº—", "ç¦å·ä¹¾éºµ", "å—æ©Ÿå ´"] },
            { name: "å¤§é›æ’ + çå¥¶", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?w=600", desc: "ç‚¸å¾—é‡‘é»ƒé…¥è„†ï¼Œç½ªæƒ¡æ„Ÿèˆ‡å¹¸ç¦æ„ŸåŒæ™‚çˆ†è¡¨ã€‚", shops: ["è±ªå¤§å¤§", "æ´¾å…‹", "å¤©ä½¿é›æ’", "è‰‹èˆº"] },
            { name: "è„†çš®è‡­è±†è…", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1583069358212-04e8d89ce58a?w=600", desc: "å¤–é…¥å…§å«©ï¼Œå¡å…¥æ³¡èœä¸€å£å’¬ä¸‹ï¼Œçµ•é…ã€‚", shops: ["é˜¿å¤§", "é‡Œé•·ä¼¯", "å¸«å¤§å¤œå¸‚"] },
            { name: "èšµä»”ç…", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1600093463592-8e36ae95ef56?w=600", desc: "Qå½ˆç²‰æ¼¿åŒ…è£¹é®®èšµèˆ‡å°ç™½èœï¼Œæ·‹ä¸Šç”œè¾£é†¬ã€‚", shops: ["å¯§å¤å¤œå¸‚", "å£«æ—å¤œå¸‚", "è³´é›è›‹"] },
            { name: "æ¸…ç²¥å°èœ", cat: "å°å¼", price: 2, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1516684732738-16fa2021c179?w=600", desc: "æ¸…æ·¡ç™½ç²¥é…ä¸Šå¤šæ¨£å°èœï¼Œæš–èƒƒåˆè±å¯Œã€‚", shops: ["å°æå­", "ç„¡åç²¥å“", "å¾©èˆˆå—è·¯"] },
            { name: "å°å¼ç†±ç‚’", cat: "å°å¼", price: 2, heavy: true, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1551249721-a4b51cc13075?w=600", desc: "å®®ä¿é›ä¸ã€é³³æ¢¨è¦çƒï¼Œé…å•¤é…’æœ€å°å‘³ã€‚", shops: ["å…ˆé€²æµ·ç”¢", "è‡¨æ´‹æ¸¯", "é•·å®‰æ±è·¯"] },
            { name: "ç«é›è‚‰é£¯", cat: "å°å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1606525437679-037aca74a3e9?w=600", desc: "é®®å«©ç«é›è‚‰çµ²æ·‹ä¸Šé›æ²¹ï¼Œé¦™æ°£å››æº¢ã€‚", shops: ["å™´æ°´", "åŠ‰é‡Œé•·", "å˜‰ç¾©é›è‚‰é£¯"] },
            { name: "æº«å·å¤§é¤›é£©", cat: "å°å¼", price: 1, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1596458397223-93c66f25459b?w=600", desc: "çš®è–„é¤¡å¤§ï¼ŒåŠ é»ç´…æ²¹æŠ„æ‰‹æ›´éç™®ã€‚", shops: ["è€è™é†¬", "æ¥Šè¨˜", "èŠ±è“®æ‰é£Ÿ"] },
            { name: "æ¶¼éºµ + å‘³å™Œæ¹¯", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1594975519808-8df04405362a?w=600", desc: "éº»é†¬é¦™æ°£é…ä¸Šå°é»ƒç“œï¼Œå¤å¤©å¿…åƒçµ„åˆã€‚", shops: ["é™³å®¶", "ç¦å¾·", "åŠ‰åª½åª½"] },
            { name: "æ½¤é¤…æ²", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1609180746973-20739c381c8b?w=600", desc: "æ»¿æ»¿è”¬èœèˆ‡èŠ±ç”Ÿç²‰ï¼Œæ¸…çˆ½åˆæœ‰é£½è¶³æ„Ÿã€‚", shops: ["é˜¿å¼˜", "ä¸­è¯ä¸€é¤…", "å¤œå¸‚æ”¤ä½"] },
            { name: "éº»è¾£é´¨è¡€", cat: "å°å¼", price: 1, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1541280910158-c4e34faf2c00?w=600", desc: "æ»‘å«©é´¨è¡€å¸æ»¿è¾£æ¹¯ï¼Œå…¥å‘³åˆé–‹èƒƒã€‚", shops: ["è©¹è¨˜", "å¤ªå’Œæ®¿", "å¤œå¸‚éº»è¾£"] },
            { name: "æ°´é¤ƒ / é‹è²¼", cat: "å°å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1534422298391-e4f8c172dddb?w=600", desc: "çš®è–„é¤¡å¤šï¼Œæ²¾é†¬æ²¹é†‹æœ€å°å‘³ã€‚", shops: ["å…«æ–¹é›²é›†", "å››æµ·éŠé¾", "äº”èŠ±é¦¬"] },

            // --- æ—¥å¼æ–™ç† ---
            { name: "æ—¥å¼æ‹‰éºµ", cat: "æ—¥å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=600", desc: "æ¿ƒéƒæ¹¯é ­é…ä¸Šå‹é“éºµæ¢ï¼Œæš–å¿ƒé¦–é¸ã€‚", shops: ["ä¸€è˜­", "å±¯äº¬", "é¬¼é‡‘æ£’", "é³¥äºº"] },
            { name: "è¿´è½‰å£½å¸", cat: "æ—¥å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=600", desc: "æ¸…çˆ½ç„¡è² æ“”ï¼Œæƒ³åƒå¤šå°‘æ‹¿å¤šå°‘ã€‚", shops: ["è—å£½å¸", "å£½å¸éƒ", "çˆ­é®®", "Hama"] },
            { name: "ç‚¸è±¬æ’å®šé£Ÿ", cat: "æ—¥å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1616428467478-43d969248232?w=600", desc: "å¤–é…¥å…§å«©çš„åšåˆ‡è±¬æ’ï¼Œé…ä¸Šé«˜éº—èœçµ²ã€‚", shops: ["å‹åšæ®¿", "æå­", "ç¦å‹äº­", "å“ç”°"] },
            { name: "ç‰›ä¸¼", cat: "æ—¥å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1554502078-ef0fc409efce?w=600", desc: "å¤§ç¢—è‚‰ç‰‡é‹ªåœ¨é£¯ä¸Šï¼Œå¿«é€Ÿæ»¿è¶³ã€‚", shops: ["å‰é‡å®¶", "Sukiya", "æ¾å±‹"] },
            { name: "æ—¥å¼å’–å“©", cat: "æ—¥å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1604152135912-04a022e23696?w=600", desc: "æ¿ƒéƒç”˜ç”œçš„æ—¥å¼å’–å“©ï¼Œå¤§äººå°å­©éƒ½æ„›ã€‚", shops: ["CoCoå£¹ç•ªå±‹", "é€šåºµ", "ä½è—¤"] },
            { name: "çƒé¾éºµ", cat: "æ—¥å¼", price: 1, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1612929633738-8fe44f7ec841?w=600", desc: "Qå½ˆæ»‘é †çš„éºµæ¢ï¼Œé…ä¸Šç‚¸ç‰©å¤©å©¦ç¾…ã€‚", shops: ["ä¸¸äº€è£½éºµ", "ç¨»ç¦¾", "åœŸä¸‰å¯’å…­"] },
            { name: "æ—¥å¼ç‡’è‚‰", cat: "æ—¥å¼", price: 3, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1592685829283-7c0bb77df3c9?w=600", desc: "äº«å—è‡ªå·±å‹•æ‰‹çƒ¤è‚‰çš„æ¨‚è¶£ï¼Œè‚‰é£Ÿè€…å¤©å ‚ã€‚", shops: ["ä¹¾æ¯", "è€ä¹¾æ¯", "ç‰›è§’", "èŒ¶å…­"] },
            { name: "å±…é…’å±‹ä¸²ç‡’", cat: "æ—¥å¼", price: 3, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1534604973900-c43ab4c2e0ab?w=600", desc: "ä¸‹ç­å¾Œçš„å°é…Œæ™‚å…‰ï¼Œç‚­ç«é¦™æ°£è¿·äººã€‚", shops: ["å³ç•™æ‰‹", "å¤§æ‘æ­¦", "æ¿€å®‰"] },
            { name: "ç”Ÿé­šç‰‡ä¸¼é£¯", cat: "æ—¥å¼", price: 3, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1562436260-8c9216eeb703?w=600", desc: "æ»¿æ»¿çš„æ–°é®®æµ·é®®é‹ªåœ¨é†‹é£¯ä¸Šï¼Œè±ªè¯äº«å—ã€‚", shops: ["çè‘—çˆ¹", "é‡‘æ³°", "ç¯‰åœ°"] },
            { name: "å¤©å©¦ç¾…ä¸¼", cat: "æ—¥å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1560155016-16e6c1cc3e53?w=600", desc: "è±ªé‚çš„ç‚¸è¦èˆ‡è”¬èœï¼Œæ·‹ä¸Šé¹¹ç”œé†¬æ±ã€‚", shops: ["é‡‘å­åŠä¹‹åŠ©", "å¤©å‰å±‹"] },
            { name: "å¤§é˜ªç‡’", cat: "æ—¥å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1563489851-9040854d9203?w=600", desc: "æ»¿æ»¿çš„é«˜éº—èœèˆ‡é…æ–™ï¼Œæ·‹ä¸Šç¾ä¹ƒæ»‹ã€‚", shops: ["åƒæˆ¿", "éµåŒ ", "é¶´æ©‹é¢¨æœˆ"] },

            // --- è¥¿å¼ & é€Ÿé£Ÿ ---
            { name: "éº¥ç•¶å‹", cat: "é€Ÿé£Ÿ", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5?w=600", desc: "ç†Ÿæ‚‰çš„å‘³é“ï¼Œè–¯æ¢æ˜¯æœ¬é«”ã€‚", shops: ["éº¥ç•¶å‹", "è‚¯å¾·åŸº", "æ¼¢å ¡ç‹"] },
            { name: "è‚¯å¾·åŸº KFC", cat: "é€Ÿé£Ÿ", price: 1, heavy: true, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?w=600", desc: "æƒ³åƒç‚¸é›å’Œè›‹å¡”çš„æ™‚å€™ï¼Œé€™æ˜¯ä¸äºŒä¹‹é¸ã€‚", shops: ["è‚¯å¾·åŸº", "æ‹¿å¡é‡Œ", "èƒ–è€çˆ¹"] },
            { name: "æŠ«è–© Pizza", cat: "è¥¿å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1513104890138-7c749659a591?w=600", desc: "ç‰½çµ²çš„èµ·å¸èˆ‡é…¥è„†é¤…çš®ï¼Œèšé¤é¦–é¸ã€‚", shops: ["å¿…å‹å®¢", "é”ç¾æ¨‚", "è˜‡é˜¿å§¨"] },
            { name: "Subway", cat: "è¥¿å¼", price: 1, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1509722747741-092075b55909?w=600", desc: "æ»¿æ»¿è”¬èœçš„æ½›è‰‡å ¡ï¼Œå¥åº·åˆæ–¹ä¾¿ã€‚", shops: ["Subway", "Quiznos"] },
            { name: "ç¾©å¤§åˆ©éºµ", cat: "è¥¿å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1473093295043-cdd812d0e601?w=600", desc: "å¥¶æ²¹ã€é’é†¬æˆ–ç•ªèŒ„ï¼Œå£å‘³å¤šè®Šã€‚", shops: ["è–„å¤šç¾©", "JAPOLI", "è–©è‰äº"] },
            { name: "ç¾å¼æ—©åˆé¤", cat: "è¥¿å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1533089862017-5614ecb3f2f2?w=600", desc: "ç­å°¼è¿ªå…‹è›‹é…å’–å•¡ï¼Œæ‚ é–’çš„ä¸€é¤ã€‚", shops: ["Second Floor", "The Diner", "Q Burger"] },
            { name: "ç‰›æ’é¤¨", cat: "è¥¿å¼", price: 3, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1600891964092-4316c288032e?w=600", desc: "æ…¶ç¥ç¯€æ—¥æˆ–çŠ’è³è‡ªå·±çš„å¥½é¸æ“‡ã€‚", shops: ["ç‹å“", "èŒ¹çµ²è‘µ", "å­«æ±å¯¶", "æ•™çˆ¶"] },
            { name: "ç¾å¼æ¼¢å ¡", cat: "è¥¿å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=600", desc: "æ‰‹å·¥è‚‰æ’å¤šæ±åšå¯¦ï¼Œå¤§å£å’¬ä¸‹è¶…æ»¿è¶³ã€‚", shops: ["KUA`AINA", "GB", "Bravo"] },
            { name: "å‡±è–©æ²™æ‹‰", cat: "è¥¿å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600", desc: "å¤§é‡ç”Ÿèœé…ä¸Šé›è‚‰èˆ‡éºµåŒ…ä¸ï¼Œè¼•ç›ˆä¸€é¤ã€‚", shops: ["Costco", "æ²™æ‹‰å°ˆè³£åº—", "è¶…å•†"] },
            { name: "ç¾©å¼ç‡‰é£¯", cat: "è¥¿å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1476124369491-e7addf5db371?w=600", desc: "å¸æ»¿é«˜æ¹¯ç²¾è¯çš„ç±³ç²’ï¼Œæ¿ƒéƒåˆé£½è¶³ã€‚", shops: ["é»‘ç±³", "éš¨æ„é³¥åœ°æ–¹"] },

            // --- ç«é‹ & æ¹¯é¡ ---
            { name: "éº»è¾£ç«é‹", cat: "ç«é‹", price: 3, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1582236357997-6a422a57ae22?w=600", desc: "é¦™è¾£éç™®ï¼Œé©åˆé‡å£å‘³èˆ‡èšé¤ã€‚", shops: ["æµ·åº•æ’ˆ", "è©¹è¨˜", "é¦¬è¾£", "è€å››å·"] },
            { name: "å€‹äººå°ç«é‹", cat: "ç«é‹", price: 1, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1547592166-23acbe34071b?w=600", desc: "ä¸€å€‹äººä¹Ÿèƒ½æš–æš–åƒé‹ï¼ŒCPå€¼é«˜ã€‚", shops: ["ä¸‰åª½", "å¤§å‘¼éç™®", "çŸ³äºŒé‹", "ç¯‰é–“"] },
            { name: "å£½å–œç‡’", cat: "æ—¥å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1584213123849-5f1118335914?w=600", desc: "é¹¹ç”œé†¬æ±æ¶®è‚‰ç‰‡ï¼Œæ²¾è›‹æ¶²è¶…æ»‘é †ã€‚", shops: ["MOMO Paradise", "ä¸€ç•ªåœ°", "æ½®è‚‰"] },
            { name: "è–‘æ¯é´¨/ç¾Šè‚‰çˆ", cat: "å°å¼", price: 2, heavy: true, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1616428467478-43d969248232?w=600", desc: "å†¬å¤©é€²è£œé¦–é¸ï¼Œç‚­ç«åŠ ç†±æ›´æœ‰å‘³ã€‚", shops: ["éœ¸å‘³", "ä¸‹æ¸¯", "é›…é¦™"] },

            // --- ç•°åœ‹ & å…¶ä»– ---
            { name: "éŸ“å¼ç‚¸é›", cat: "éŸ“å¼", price: 2, heavy: true, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?w=600", desc: "è£¹æ»¿ç”œè¾£é†¬æ±çš„é…¥è„†ç‚¸é›ï¼Œé…é†ƒè˜¿è””ã€‚", shops: ["èµ·å®¶é›", "bb.q", "Nene"] },
            { name: "éŸ“å¼æ³¡èœé‹", cat: "éŸ“å¼", price: 2, heavy: false, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1596458397260-255551c09534?w=600", desc: "é…¸è¾£é–‹èƒƒï¼Œé…ä¸Šä¸€ç¢—ç™½é£¯å‰›å‰›å¥½ã€‚", shops: ["æ¶“è±†è…", "åŒ—æ‘", "ä¸‰å…ƒ"] },
            { name: "çŸ³é‹æ‹Œé£¯", cat: "éŸ“å¼", price: 2, heavy: false, soup: false, spicy: true, img: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=600", desc: "é…¥è„†é‹å·´é…ä¸Šè±å¯Œé…èœï¼Œæ‹Œåœ¨ä¸€èµ·åƒã€‚", shops: ["éŸ“é¶´äº­", "é«˜éº—åœ’"] },
            { name: "æ³°å¼æ–™ç†", cat: "æ³°å¼", price: 2, heavy: false, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1559314809-0d155014e29e?w=600", desc: "é…¸è¾£é–‹èƒƒï¼Œæœˆäº®è¦é¤…å¿…é»ã€‚", shops: ["ç“¦åŸ", "NARA", "æ³°å¸‚å ´"] },
            { name: "è¶Šå—æ²³ç²‰", cat: "è¶Šå¼", price: 1, heavy: false, soup: true, spicy: false, img: "https://images.unsplash.com/photo-1582878826629-29b7ad1cdc43?w=600", desc: "æ¸…ç”œæ¹¯é ­é…ä¸Šæ»‘é †æ²³ç²‰ï¼Œæ¸…çˆ½é¸æ“‡ã€‚", shops: ["èª è¨˜", "L.A PHO", "CYCLO"] },
            { name: "å°ç± åŒ…", cat: "ä¸­å¼", price: 3, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1563245372-f21724e3856d?w=600", desc: "çš®è–„æ±å¤šï¼Œæ­é…è–‘çµ²é†‹ä¸€å£å’¬ä¸‹ã€‚", shops: ["é¼æ³°è±", "é»æ°´æ¨“", "æ­å·å°ç± æ¹¯åŒ…"] },
            { name: "æ¸¯å¼é£²èŒ¶", cat: "æ¸¯å¼", price: 2, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1541696490865-e6f720e9c195?w=600", desc: "ç‡’è³£ã€è¦é¤ƒã€å‰ç‡’åŒ…ï¼Œæ¨£æ¨£éƒ½ä¾†ä¸€é»ã€‚", shops: ["é»é»å¿ƒ", "æ·»å¥½é‹", "äº¬æ˜Ÿ"] },
            { name: "ç‡’è‡˜ä¾¿ç•¶", cat: "æ¸¯å¼", price: 1, heavy: true, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1552611052-33e04de081de?w=600", desc: "æ²¹é›ã€ç‡’é´¨ã€å‰ç‡’ï¼Œé…ä¸Šè”¥æ²¹æœ€ä¸‹é£¯ã€‚", shops: ["é³³åŸ", "é¦™æ¸¯å®¶é´»", "å¥½å‘³"] },
            { name: "å¥åº·é¤ç›’", cat: "å¥åº·", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600", desc: "æ°´ç…®ä½å¡ï¼Œå¢è‚Œæ¸›è„‚é¦–é¸ã€‚", shops: ["èƒ½é‡å°å§", "å¥åº·æ°´ç…®", "Just Kitchen"] },
            { name: "å°åº¦å’–å“©", cat: "ç•°åœ‹", price: 2, heavy: true, soup: true, spicy: true, img: "https://images.unsplash.com/photo-1604152135912-04a022e23696?w=600", desc: "é¦™æ–™å‘³æ¿ƒéƒï¼Œé…çƒ¤é¤…ä¸€çµ•ã€‚", shops: ["Saffron", "é¦¬å‹å‹", "Taj"] },
            { name: "å¤å¨å¤·æ‹Œé£¯", cat: "ç¾å¼", price: 2, heavy: false, soup: false, spicy: false, img: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=600", desc: "ç”Ÿé­šç‰‡é…å¤§é‡è”¬èœï¼Œæ¸…çˆ½ç„¡è² æ“”ã€‚", shops: ["HALOA", "PokÃ© Shop", "JJ's"] }
        ];

        // === é‚è¼¯å€ ===
        let userPref = { price: 0, heavy: null }; // 0=all, 1=cheap, 2=mid, 3=high
        let pool = [];
        let currentItem = null;

        // 1. å•å·é‚è¼¯
        function nextStep(current, key, value) {
            userPref[key] = value;
            document.getElementById(`step${current}`).classList.remove('active');
            document.getElementById(`step${current+1}`).classList.add('active');
        }

        // 2. é–‹å§‹éŠæˆ² (åˆå§‹åŒ–ç¯©é¸)
        function startGame(type) {
            // éš±è—å•å·
            document.getElementById('onboarding').classList.add('hidden');
            
            // åˆæ­¥ç¯©é¸è³‡æ–™åº«
            pool = database.filter(item => {
                // åƒ¹æ ¼ç¯©é¸ (0ä»£è¡¨æ²’å·®)
                if (userPref.price !== 0 && item.price !== userPref.price) return false;
                
                // é¤“åº¦ç¯©é¸ (heavy: true=é£½/æ²¹, false=è¼•é£Ÿ)
                if (userPref.heavy !== null && item.heavy !== userPref.heavy) return false;

                // é¡å‹ç¯©é¸ (Q3)
                if (type === 'soup' && !item.soup) return false;
                if (type === 'dry' && item.soup) return false;
                if (type === 'spicy' && !item.spicy) return false;
                
                return true;
            });

            if (pool.length === 0) {
                alert("æ¢ä»¶å¤ªåš´è‹›ï¼Œæ‰¾ä¸åˆ°é¤å»³ï¼å°‡æ”¾å¯¬æ¢ä»¶...");
                pool = [...database]; // é‡ç½®
            }

            renderCard();
        }

        // 3. æ¸²æŸ“å¡ç‰‡
        function renderCard() {
            if (pool.length === 0) {
                alert("é¸é …éƒ½çœ‹å®Œäº†ï¼å°‡é‡æ–°å¾ªç’°...");
                pool = [...database];
            }

            // éš¨æ©ŸæŠ½ä¸€å¼µ
            const idx = Math.floor(Math.random() * pool.length);
            currentItem = pool[idx];

            // ç§»é™¤å‹•ç•«classä»¥é‡æ’­
            const card = document.getElementById('cardContainer');
            card.style.animation = 'none';
            card.offsetHeight; // trigger reflow
            card.style.animation = 'popIn 0.3s';

            // å¡«å…¥è³‡æ–™
            document.getElementById('fImg').src = currentItem.img;
            document.getElementById('fName').innerText = currentItem.name;
            document.getElementById('fDesc').innerText = currentItem.desc;
            
            // åƒ¹æ ¼é¡¯ç¤º
            let pStr = "";
            for(let i=0; i<currentItem.price; i++) pStr += "$";
            document.getElementById('fPrice').innerText = pStr;

            // ååº—æ¨™ç±¤
            document.getElementById('fShops').innerHTML = currentItem.shops.map(s => `<span class="shop-tag">${s}</span>`).join('');
        }

        // 4. æŒ‰éˆ•æ“ä½œ
        function nextCard() {
            // å–®ç´”æ›ä¸€å¼µ (ä¸ç§»é™¤)
            renderCard();
        }

        function filterOut(reason) {
            showToast("å·²éæ¿¾æ¢ä»¶ï¼Œæœå°‹ä¸­...");
            
            // å¾æ± ä¸­ç§»é™¤ç•¶å‰é€™å€‹
            pool = pool.filter(i => i.name !== currentItem.name);

            // æ ¹æ“šç†ç”±ç§»é™¤æ›´å¤š
            if (reason === 'cat') {
                pool = pool.filter(i => i.cat !== currentItem.cat);
            } else if (reason === 'heavy') {
                pool = pool.filter(i => !i.heavy);
            } else if (reason === 'spicy') {
                pool = pool.filter(i => !i.spicy);
            } else if (reason === 'expensive') {
                pool = pool.filter(i => i.price < currentItem.price);
            } else if (reason === 'rice') {
                pool = pool.filter(i => !i.name.includes('é£¯') && !i.name.includes('ä¸¼'));
            } else if (reason === 'noodle') {
                pool = pool.filter(i => !i.name.includes('éºµ') && !i.name.includes('ç²‰'));
            }

            renderCard();
        }

        function confirmChoice() {
            document.getElementById('successOverlay').classList.add('show');
            document.getElementById('finalImg').src = currentItem.img;
            document.getElementById('finalName').innerText = currentItem.name;
            
            // Google Maps æœå°‹é€£çµ
            const q = encodeURIComponent(currentItem.name + " é™„è¿‘");
            document.getElementById('mapLink').href = `https://www.google.com/maps/search/${q}`;
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.opacity = 1;
            setTimeout(() => t.style.opacity = 0, 2000);
        }

    </script>
</body>
</html>