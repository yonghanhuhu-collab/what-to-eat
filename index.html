<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ä»Šå¤©åƒä»€éº¼ï¼Ÿ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">

    <style>
        /* 1. åŸºç¤è®Šæ•¸ */
        :root {
            --bg: #F0F2F5;
            --primary: #FF6B6B;
            --radius: 24px;
            --shadow: 0 10px 30px rgba(0,0,0,0.08);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { 
            margin: 0; padding: 0; font-family: 'Noto Sans TC', sans-serif; 
            background: var(--bg); color: #333; 
            height: 100dvh; overflow: hidden; display: flex; flex-direction: column;
        }

        /* 2. UI å…ƒä»¶ */
        .header {
            padding: 15px 25px; display: flex; justify-content: space-between; align-items: center;
            font-weight: 900; color: #5F7D8B; background: var(--bg); z-index: 10;
            padding-top: max(20px, env(safe-area-inset-top));
        }
        .heart-counter {
            background: #fff; padding: 6px 14px; border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); color: var(--primary); font-weight: bold; font-size: 14px;
        }
        .view {
            flex: 1; display: none; flex-direction: column; 
            align-items: center; justify-content: flex-start;
            padding: 20px; position: relative; width: 100%;
            overflow-y: auto; padding-bottom: max(60px, env(safe-area-inset-bottom));
            animation: fadeIn 0.4s ease;
        }
        .view.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .question-title { 
            font-size: 24px; font-weight: 900; color: #455A64; margin: 10px 0 20px 0; text-align: center;
        }
        .option-btn {
            width: 100%; max-width: 340px; background: white; 
            padding: 16px; margin-bottom: 12px; border-radius: 16px;
            font-size: 17px; font-weight: 700; text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.04); cursor: pointer;
            transition: transform 0.1s;
        }
        .option-btn:active { transform: scale(0.98); background: #f0f0f0; }

        .mode-btn {
            width: 100%; max-width: 340px; height: 160px;
            background: white; border-radius: 24px; margin-bottom: 20px; padding: 20px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: var(--shadow); cursor: pointer; transition: transform 0.2s;
        }
        .mode-btn:active { transform: scale(0.96); }
        .mode-icon { font-size: 48px; margin-bottom: 15px; }
        .mode-title { font-size: 22px; font-weight: 900; margin-bottom: 5px; }
        .mode-desc { font-size: 14px; color: #888; }
        .mode-btn.morning { border: 3px solid #FFD93D; background: linear-gradient(to bottom right, #fff, #FFFDE7); }
        .mode-btn.night { border: 3px solid #5F7D8B; background: linear-gradient(to bottom right, #fff, #ECEFF1); }

        /* å¡ç‰‡è¨­è¨ˆ - é‡æ§‹åœ–ç‰‡è¼‰å…¥å±¤ */
        .card-container {
            width: 100%; max-width: 340px; aspect-ratio: 3/4.5;
            position: relative; perspective: 1000px; margin: auto 0;
        }
        .food-card {
            position: absolute; inset: 0; background: white; border-radius: var(--radius);
            box-shadow: var(--shadow); overflow: hidden;
            display: flex; flex-direction: column;
            transform-origin: 50% 100%; transition: transform 0.3s, opacity 0.3s;
        }
        .card-img-wrapper {
            height: 55%; width: 100%; background-color: #f0f0f0;
            position: relative; overflow: hidden;
        }
        /* çœŸæ­£çš„åœ–ç‰‡å±¤ */
        .card-img-layer {
            width: 100%; height: 100%;
            background-size: cover; background-position: center;
            opacity: 0; transition: opacity 0.4s ease; /* é è¨­éš±è—ï¼Œè¼‰å…¥å¥½æ‰æ·¡å…¥ */
        }
        /* æœå°‹ä¸­çš„æ–‡å­—å±¤ - çµ•å°å®šä½åœ¨åœ–ç‰‡ä¸Š */
        .loading-text {
            position: absolute; inset: 0;
            display: flex; align-items: center; justify-content: center;
            color: #888; font-weight: bold; font-size: 15px;
            background: #f8f9fa; z-index: 1;
            transition: opacity 0.3s;
        }
        .card-content { padding: 25px; flex: 1; display: flex; flex-direction: column; background: white; }
        .card-title { font-size: 26px; font-weight: 900; margin-bottom: 10px; }
        .tags { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
        .tag { font-size: 12px; background: #F5F7F9; color: #607D8B; padding: 5px 10px; border-radius: 8px; font-weight: 600; }
        .desc { font-size: 15px; color: #777; line-height: 1.5; flex: 1; }

        .filter-tags { 
            display: flex; gap: 10px; margin-top: auto; padding-top: 15px;
            overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; width: 100%;
        }
        .filter-chip {
            background: #fff; border: 1px solid #ddd; padding: 8px 16px; 
            border-radius: 50px; font-size: 14px; font-weight: 700; color: #555; 
            display: flex; align-items: center; justify-content: center; gap: 6px;
            cursor: pointer; white-space: nowrap; transition: all 0.2s; flex-shrink: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .action-bar {
            display: flex; gap: 25px; margin-top: 20px; justify-content: center; padding-bottom: 20px;
        }
        .big-btn {
            width: 65px; height: 65px; border-radius: 50%;
            background: white; border: none; box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            font-size: 26px; cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .btn-pass { color: #ccc; }
        .btn-like { color: var(--primary); background: #FFF5F5; }

        /* çµæœé èª¿æ•´ */
        .podium-item {
            background: white; padding: 15px; border-radius: 16px; margin-bottom: 12px;
            display: flex; align-items: center; gap: 15px; cursor: pointer;
            border: 3px solid transparent; box-shadow: 0 4px 10px rgba(0,0,0,0.03);
        }
        .podium-item.highlight {
            border-color: var(--primary); background-color: #FFF5F5; transform: scale(1.02);
        }
        .p-img { width: 65px; height: 65px; border-radius: 12px; background-color: #eee; background-size: cover; background-position: center; flex-shrink: 0; }
        
        .result-img-circle {
            width: 220px; height: 220px; border-radius: 50%; 
            background-color: #eee; margin-bottom: 25px; border: 6px solid white;
            box-shadow: var(--shadow); background-size: cover; background-position: center;
        }
        .map-btn {
            background: #546E7A; color: white; width: 100%; max-width: 340px;
            padding: 18px; border-radius: 30px; text-decoration: none;
            display: flex; align-items: center; justify-content: center; gap: 10px;
            font-weight: bold; margin-top: 30px;
        }
        .dice-btn {
            margin-top: 25px; width: 100%; max-width: 360px;
            background: white; border: 2px solid #eee; padding: 16px;
            border-radius: 30px; font-weight: 800; color: #5F7D8B; font-size: 16px; margin-bottom: 40px;
        }
    </style>
</head>
<body>

    <div class="header">
        <div>ä»Šå¤©åƒä»€éº¼</div>
        <div class="heart-counter" id="counter" style="display:none;">â¤ï¸ 0 / 3</div>
    </div>

    <div id="v-entrance" class="view active" style="justify-content: center;">
        <div class="mode-btn morning" onclick="selectMode('breakfast')">
            <div class="mode-icon">â˜€ï¸</div>
            <div class="mode-title">é–‹å•Ÿä¸€å¤©</div>
            <div class="mode-desc">æ—©é¤ã€æ—©åˆé¤ã€è¼•é£Ÿ</div>
        </div>
        <div class="mode-btn night" onclick="selectMode('regular')">
            <div class="mode-icon">ğŸŒ™</div>
            <div class="mode-title">å¡«é£½è‚šå­</div>
            <div class="mode-desc">åˆé¤ã€æ™šé¤ã€å®µå¤œ</div>
        </div>
    </div>

    <div id="v-hunger" class="view">
        <div class="question-title">ç¾åœ¨é¤“å—ï¼Ÿ</div>
        <div class="option-btn" onclick="nextStep('hunger', 'light')">ğŸ¥— ä¸å¤ªé¤“ï¼Œè¼•é£Ÿå°±å¥½</div>
        <div class="option-btn" onclick="nextStep('hunger', 'full')">ğŸ– è¶…é¤“ï¼Œæˆ‘è¦åƒé£½</div>
        <div class="option-btn" onclick="nextStep('hunger', 'any')">ğŸ¤· éƒ½çµ¦</div>
    </div>

    <div id="v-mood" class="view">
        <div class="question-title">æƒ³åƒå“ªç¨®é¡å‹ï¼Ÿ</div>
        <div class="option-btn" onclick="nextStep('mood', 'soup')">ğŸ¥£ æƒ³å–ç†±æ¹¯</div>
        <div class="option-btn" onclick="nextStep('mood', 'dry')">ğŸ¥¢ æƒ³åƒä¹¾çš„</div>
        <div class="option-btn" onclick="nextStep('mood', 'spicy')">ğŸŒ¶ï¸ æƒ³åƒè¾£ï¼</div>
        <div class="option-btn" onclick="nextStep('mood', 'any')">ğŸŒˆ æ²’æƒ³æ³•ï¼Œçµ¦æˆ‘é©šå–œ</div>
    </div>

    <div id="v-budget" class="view">
        <div class="question-title">é ç®—ç¯„åœï¼Ÿ</div>
        <div class="option-btn" onclick="nextStep('budget', 1)">ğŸ’° ä¾¿å®œç°¡å–®åƒ ($)</div>
        <div class="option-btn" onclick="nextStep('budget', 2)">ğŸ’µ ä¸€èˆ¬èšé¤åƒ¹ä½ ($$)</div>
        <div class="option-btn" onclick="nextStep('budget', 3)">ğŸ’ è±ªè¯å¤§é¤ ($$$)</div>
        <div class="option-btn" onclick="nextStep('budget', 0)">ğŸ’¸ æ²’å·®ï¼Œçœ‹æ„Ÿè¦º</div>
    </div>

    <div id="v-bf-style" class="view">
        <div class="question-title">æ—©é¤æƒ³åƒå“ªä¸€æ´¾ï¼Ÿ</div>
        <div class="option-btn" onclick="nextStep('style', 'chn')">ğŸ¥¢ ä¸­å¼å‚³çµ± (è›‹é¤…/é£¯ç³°)</div>
        <div class="option-btn" onclick="nextStep('style', 'west')">ğŸ” è¥¿å¼/æ—©åˆé¤ (æ¼¢å ¡/æ‹¼ç›¤)</div>
        <div class="option-btn" onclick="nextStep('style', 'quick')">ğŸ ç°¡å–®è¶…å•† (éºµåŒ…/èŒ¶è‘‰è›‹)</div>
        <div class="option-btn" onclick="nextStep('style', 'any')">ğŸ¤· æ²’å·®ï¼Œéƒ½å¯ä»¥</div>
    </div>

    <div id="v-bf-vibe" class="view">
        <div class="question-title">ä»Šå¤©çš„ç¯€å¥ï¼Ÿ</div>
        <div class="option-btn" onclick="nextStep('vibe', 'rush')">ğŸƒ è¶•æ™‚é–“ï¼Œå¸¶è‘—èµ°</div>
        <div class="option-btn" onclick="nextStep('vibe', 'chill')">â˜•ï¸ æ‚ é–’ï¼Œåä¸‹ä¾†åƒ</div>
        <div class="option-btn" onclick="nextStep('vibe', 'any')">ğŸŒˆ çœ‹å¿ƒæƒ…</div>
    </div>

    <div id="v-swipe" class="view">
        <div class="card-container" id="cardStack"></div>
        <div class="action-bar">
            <button class="big-btn btn-pass" onclick="handleSwipe(false)"><i class="fas fa-times"></i></button>
            <button class="big-btn btn-like" onclick="handleSwipe(true)"><i class="fas fa-heart"></i></button>
        </div>
    </div>

    <div id="v-podium" class="view">
        <div class="question-title">æ±ºé¸æ“‚å° ğŸ‘‘</div>
        <div style="text-align:center; color:#999; margin-bottom:25px; font-size:14px;">é€™ 3 å®¶é¸ä¸€å®¶ï¼Œäº¤çµ¦å‘½é‹ï¼</div>
        <div class="podium-list" id="podiumList"></div>
        <button class="dice-btn" id="startBtn" onclick="startRoulette()"><i class="fas fa-dice"></i> å¹«æˆ‘é¸ï¼</button>
    </div>

    <div id="v-result" class="view">
        <div class="result-img-circle" id="resImg"></div>
        <div style="font-size:14px; color:#999; margin-bottom:5px;">å‘½é‹æ±ºå®šåƒé€™å€‹ï¼</div>
        <h1 style="font-size:32px; margin:0; margin-bottom:20px; color:#333;" id="resName">Result</h1>
        <div class="tags" id="resTags" style="justify-content:center;"></div>
        
        <a id="resLink" href="#" target="_blank" class="map-btn">
            <i class="fas fa-location-arrow"></i> æœå°‹é™„è¿‘åº—å®¶
        </a>
        <div style="margin-top:25px; text-decoration:underline; color:#999; cursor:pointer; font-size:14px;" onclick="location.reload()">å›é¦–é </div>
    </div>

    <script>
    // [è³‡æ–™åº«å‡ç´š] 
    // n: åç¨±
    // k: å¼·åˆ¶æœå°‹é—œéµå­— (è§£æ±ºæ˜Ÿå·´å…‹è®Šå»ºç¯‰ç‰©ã€å°å¼å°åƒæœä¸åˆ°çš„å•é¡Œ)
    // t: æ¨™ç±¤, p: åƒ¹æ ¼, f: ç¯©é¸tag, d: æè¿°
    
    const dinnerDB = [
        { n: "è±šéª¨æ‹‰éºµ", k: "ramen", t: ["æ—¥å¼", "æœ‰æ¹¯"], p: 2, f: ["soup", "greasy", "full"], d: "æ¿ƒéƒæ¹¯é ­ï¼Œæš–èƒƒé¦–é¸" },
        { n: "æ—¥å¼æ²¾éºµ", k: "tsukemen", t: ["æ—¥å¼", "Qå½ˆ"], p: 2, f: ["dry", "full"], d: "æ¿ƒåšé†¬æ±å¸é™„éºµæ¢" },
        { n: "æ—¥å¼ç‰›ä¸¼", k: "gyudon", t: ["æ—¥å¼", "å¿«é€Ÿ"], p: 1, f: ["dry", "full"], d: "ç”œé¹¹é†¬æ±æ‹Œé£¯" },
        { n: "ç‚¸è±¬æ’å®šé£Ÿ", k: "tonkatsu", t: ["æ—¥å¼", "é£½è¶³"], p: 2, f: ["dry", "greasy", "full"], d: "å¤–é…¥å…§å«©åšåˆ‡è±¬æ’" },
        { n: "è¿´è½‰å£½å¸", k: "sushi", t: ["æ—¥å¼", "æ¸…çˆ½"], p: 2, f: ["dry", "light"], d: "å¤šæ¨£åŒ–é¸æ“‡" },
        { n: "æ—¥å¼å’–å“©é£¯", k: "Japanese curry rice", t: ["æ—¥å¼", "æ¿ƒéƒ"], p: 2, f: ["dry", "full"], d: "ç”˜ç”œæ¿ƒéƒçš„æ—¥å¼é¢¨å‘³" },
        { n: "æ—¥å¼ç‡’è‚‰", k: "yakiniku", t: ["æ—¥å¼", "èšé¤"], p: 3, f: ["dry", "greasy", "full"], d: "è‡ªå·±çƒ¤è‚‰çš„æ¨‚è¶£" },
        { n: "å£½å–œç‡’", k: "sukiyaki", t: ["æ—¥å¼", "é‹ç‰©"], p: 3, f: ["soup", "full"], d: "ç”œé¹¹é†¬æ±æ¶®ç‰›è‚‰" },
        { n: "çƒé¾éºµ", k: "udon", t: ["æ—¥å¼", "Qå½ˆ"], p: 1, f: ["soup", "light"], d: "ç°¡å–®æ¸…çˆ½çš„æŸ´é­šæ¹¯é ­" },
        { n: "ç« é­šç‡’", k: "takoyaki", t: ["æ—¥å¼", "å°åƒ"], p: 1, f: ["dry", "light"], d: "å¤–é…¥å…§è»Ÿçš„å°é»å¿ƒ" },
        { n: "é°»é­šé£¯", k: "unagi don", t: ["æ—¥å¼", "é«˜ç´š"], p: 3, f: ["dry", "full"], d: "ç‚­çƒ¤é¦™æ°£ï¼Œè£œå…ƒæ°£" },
        
        { n: "ç´…ç‡’ç‰›è‚‰éºµ", k: "Taiwanese beef noodle soup", t: ["å°å¼", "ç¶“å…¸"], p: 2, f: ["soup", "spicy", "full"], d: "å°ç£äººæœ€æ„›çš„ç¶“å…¸" },
        { n: "æ»·è‚‰é£¯", k: "braised pork rice", t: ["å°å¼", "å¿…åƒ"], p: 1, f: ["dry", "greasy", "full"], d: "åœ‹æ°‘ç¾é£Ÿï¼Œè‚¥ç˜¦é©ä¸­" },
        { n: "å°ç± åŒ…", k: "xiaolongbao", t: ["ä¸­å¼", "çˆ†æ¼¿"], p: 2, f: ["dry", "light"], d: "çš®è–„é¤¡å¤šæ¹¯æ±é®®ç¾" },
        { n: "é‹è²¼", k: "potstickers", t: ["å°å¼", "æ–¹ä¾¿"], p: 1, f: ["dry", "greasy", "full"], d: "é…¥è„†å¤–çš®èˆ‡å¤šæ±å…§é¤¡" },
        { n: "éº»è¾£ç«é‹", k: "spicy hot pot", t: ["ä¸­å¼", "èšé¤"], p: 3, f: ["soup", "spicy", "greasy", "full"], d: "é¦™è¾£éç™®ï¼Œé©åˆå¤šäºº" },
        { n: "ç«é›è‚‰é£¯", k: "turkey rice", t: ["å°å¼", "å˜‰ç¾©"], p: 1, f: ["dry", "greasy", "full"], d: "é›æ²¹é¦™æ°£åè¶³" },
        { n: "æ’éª¨é£¯", k: "pork chop rice", t: ["å°å¼", "ä¾¿ç•¶"], p: 1, f: ["dry", "greasy", "full"], d: "å¤æ—©å‘³ç‚¸æ’éª¨" },
        { n: "æ¸…ç²¥å°èœ", k: "congee", t: ["å°å¼", "æ¸…æ·¡"], p: 2, f: ["soup", "light"], d: "æš–èƒƒåˆæ¸…çˆ½" },
        { n: "èšµä»”ç…", k: "oyster omelet", t: ["å°å¼", "å°åƒ"], p: 1, f: ["dry", "greasy", "light"], d: "å¤œå¸‚å¿…åƒç¾é£Ÿ" },
        { n: "è‡­è‡­é‹", k: "hot pot", t: ["å°å¼", "å°ç«é‹"], p: 1, f: ["soup", "spicy", "full"], d: "å¹³åƒ¹äº«å—ï¼Œæ–™å¤šå¯¦åœ¨" },
        { n: "æ“”ä»”éºµ", k: "danzai noodles", t: ["å°å¼", "å‚³çµ±"], p: 1, f: ["soup", "light"], d: "è‚‰ç‡¥é¦™æ°£æ’²é¼»" },
        { n: "å¤§è…¸åŒ…å°è…¸", k: "sausage", t: ["å°å¼", "å°åƒ"], p: 1, f: ["dry", "greasy", "light"], d: "å°å¼ç†±ç‹—å ¡" },
        
        { n: "ç¾å¼æ¼¢å ¡", k: "burger", t: ["ç¾å¼", "å¤§å£åƒ"], p: 2, f: ["dry", "greasy", "full"], d: "å¤šæ±ç‰›è‚‰æ’é…èµ·å¸" },
        { n: "ç¾©å¤§åˆ©éºµ", k: "pasta", t: ["ç¾©å¼", "å¤šæ¨£"], p: 2, f: ["dry", "full"], d: "ç´…é†¬ç™½é†¬é’é†¬ä»»é¸" },
        { n: "çª¯çƒ¤æŠ«è–©", k: "pizza", t: ["ç¾©å¼", "åˆ†äº«"], p: 2, f: ["dry", "greasy", "full"], d: "è–„è„†é¤…çš®ï¼Œç‰½çµ²èµ·å¸" },
        { n: "ç‰›æ’", k: "steak", t: ["è¥¿å¼", "æ…¶ç¥"], p: 3, f: ["dry", "greasy", "full"], d: "å¤§å£åƒè‚‰çš„æ»¿è¶³æ„Ÿ" },
        { n: "æ½›è‰‡å ¡", k: "sub sandwich", t: ["ç¾å¼", "å¥åº·"], p: 1, f: ["dry", "light"], d: "è”¬èœæ»¿æ»¿ï¼Œæ¸…çˆ½ç„¡è² æ“”" },
        { n: "ç‚¸é›", k: "fried chicken", t: ["ç¾å¼", "ç½ªæƒ¡"], p: 2, f: ["dry", "greasy", "full"], d: "é…¥è„†å¤–çš®å¤šæ±é›è‚‰" },
        { n: "ç‡‰é£¯", k: "risotto", t: ["ç¾©å¼", "æ¿ƒéƒ"], p: 2, f: ["dry", "full"], d: "ç±³å¿ƒå¾®ç¡¬å£æ„Ÿ" },
        { n: "å‡±è–©æ²™æ‹‰", k: "caesar salad", t: ["è¥¿å¼", "æ¸›è„‚"], p: 2, f: ["dry", "light"], d: "è¼•é£Ÿä¸»ç¾©é¦–é¸" },
        { n: "éŸ“å¼ç‚¸é›", k: "korean fried chicken", t: ["éŸ“å¼", "ç”œè¾£"], p: 2, f: ["dry", "spicy", "greasy", "full"], d: "è£¹é†¬ç‚¸é›é…å•¤é…’" },
        { n: "çŸ³é‹æ‹Œé£¯", k: "bibimbap", t: ["éŸ“å¼", "é‹å·´"], p: 2, f: ["dry", "spicy", "full"], d: "è±å¯Œé…èœæ‹Œè¾£é†¬" },
        { n: "éŸ“å¼æ³¡èœé‹", k: "kimchi stew", t: ["éŸ“å¼", "é…¸è¾£"], p: 2, f: ["soup", "spicy", "full"], d: "é…¸è¾£é–‹èƒƒç†±æ¹¯" },
        { n: "æ³°å¼æ‰“æ‹‹è±¬", k: "pad krapow", t: ["æ³°å¼", "ä¸‹é£¯"], p: 1, f: ["dry", "spicy", "greasy", "full"], d: "é…¸è¾£é¹¹é¦™ï¼Œç™½é£¯æ®ºæ‰‹" },
        { n: "è¶Šå—æ²³ç²‰", k: "pho", t: ["è¶Šå¼", "æ¸…çˆ½"], p: 1, f: ["soup", "light"], d: "æ¸…ç”œæ¹¯é ­é…æª¸æª¬" },
        { n: "æµ·å—é›é£¯", k: "hainanese chicken rice", t: ["æ˜Ÿé¦¬", "å«©é›"], p: 1, f: ["dry", "greasy", "full"], d: "é›è‚‰æ»‘å«©ï¼Œé›æ²¹é£¯é¦™" },
        { n: "å°åº¦å’–å“©", k: "indian curry", t: ["ç•°åœ‹", "é¦™æ–™"], p: 2, f: ["soup", "spicy", "full"], d: "é¦™æ–™å±¤æ¬¡è±å¯Œé…çƒ¤é¤…" },

        { n: "éº»è¾£ç‡™", k: "spicy hot pot", t: ["ä¸­å¼", "å€‹äºº"], p: 1, f: ["soup", "spicy", "light"], d: "æƒ³åƒä»€éº¼å¤¾ä»€éº¼" },
        { n: "é¹¹é…¥é›", k: "fried chicken", t: ["å°å¼", "å®µå¤œ"], p: 1, f: ["dry", "greasy", "light"], d: "å°ç£å‘³ç‚¸ç‰©æ‹¼ç›¤" },
        { n: "æ¶¼éºµ", k: "cold noodles", t: ["å°å¼", "æ¶ˆæš‘"], p: 1, f: ["dry", "light"], d: "éº»é†¬é¦™æ°£æ¿ƒéƒ" },
        { n: "éµæ¿ç‡’", k: "teppanyaki", t: ["å°å¼", "ç¾ç‚’"], p: 2, f: ["dry", "greasy", "full"], d: "å¸«å‚…ç¾ç‚’é’èœèˆ‡ä¸»é£Ÿ" },
        { n: "ç‚’é£¯", k: "fried rice", t: ["ä¸­å¼", "é‘Šæ°£"], p: 1, f: ["dry", "greasy", "full"], d: "ç²’ç²’åˆ†æ˜" },
        { n: "ç‚’éºµ", k: "chow mein", t: ["å°å¼", "å®¶å¸¸"], p: 1, f: ["dry", "greasy", "full"], d: "å¤§ç«å¿«ç‚’é¦™æ°£" },
        { n: "è‚‰åœ“", k: "bawan", t: ["å°å¼", "Qå½ˆ"], p: 1, f: ["dry", "greasy", "light"], d: "ä½æº«æ²¹æ³¡å¤–çš®Qå½ˆ" },
        { n: "é—œæ±ç…®", k: "oden", t: ["æ—¥å¼", "æ¸…æ·¡"], p: 1, f: ["soup", "light"], d: "ä¾¿åˆ©å•†åº—çš„æº«æš–" },
        { n: "æ¸¯å¼ç‡’è‡˜", k: "cantonese bbq pork", t: ["æ¸¯å¼", "æ²¹é›"], p: 1, f: ["dry", "greasy", "full"], d: "è”¥æ²¹é…ä¸Šç‡’é´¨æ²¹é›" },
        { n: "æ¸¯å¼é»å¿ƒ", k: "dim sum", t: ["æ¸¯å¼", "é£²èŒ¶"], p: 2, f: ["dry", "light"], d: "ç‡’è³£ã€è¦é¤ƒã€å‰ç‡’åŒ…" },
        { n: "é…¸èœç™½è‚‰é‹", k: "hot pot", t: ["ä¸­å¼", "é…¸çˆ½"], p: 3, f: ["soup", "full"], d: "é…¸ç™½èœé…äº”èŠ±è‚‰" },
        { n: "å¤§é›æ’", k: "fried chicken steak", t: ["å°å¼", "é‚ªæƒ¡"], p: 1, f: ["dry", "greasy", "light"], d: "å®µå¤œéœ¸ä¸»" },
        { n: "IKEAé¤å»³", k: "meatballs", t: ["ç‘å…¸", "è‚‰ä¸¸"], p: 2, f: ["dry", "full"], d: "è‚‰ä¸¸èˆ‡ç‚¸é›ç¿…" },
        { n: "ä¾¿åˆ©å•†åº—", k: "convenience store food", t: ["è¶…å•†", "å¿«é€Ÿ"], p: 1, f: ["dry", "full"], d: "å¾®æ³¢å³é£Ÿ" },
        { n: "éº¥ç•¶å‹", k: "big mac", t: ["ç¾å¼", "é€Ÿé£Ÿ"], p: 1, f: ["dry", "greasy", "full"], d: "è–¯æ¢æ˜¯æœ¬é«”" },
        { n: "è‚¯å¾·åŸº", k: "fried chicken bucket", t: ["ç¾å¼", "è›‹å¡”"], p: 2, f: ["dry", "greasy", "full"], d: "è¢«ç‚¸é›è€½èª¤çš„è›‹å¡”åº—" },
        { n: "è±†èŠ±", k: "tofu pudding", t: ["ç”œé»", "å¤æ—©"], p: 1, f: ["soup", "light"], d: "ç¶¿å¯†è±†é¦™é…èŠ±ç”Ÿ" }
    ];

    const breakfastDB = [
        { n: "è›‹é¤…", k: "Taiwanese egg pancake", t: ["ä¸­å¼", "ç¶“å…¸"], p: 1, f: ["chn", "rush", "quick"], d: "é®ªé­šã€ç‰ç±³ã€èµ·å¸ä»»é¸" },
        { n: "é£¯ç³°", k: "sticky rice roll", t: ["ä¸­å¼", "é£½è¶³"], p: 1, f: ["chn", "rush", "full"], d: "ç´«ç±³é£¯ç³°åŠ æ²¹æ¢" },
        { n: "ç‡’é¤…æ²¹æ¢", k: "youtiao", t: ["ä¸­å¼", "é…¥è„†"], p: 1, f: ["chn", "chill"], d: "é…è±†æ¼¿çµ•é…" },
        { n: "å°ç± æ¹¯åŒ…", k: "xiaolongbao", t: ["ä¸­å¼", "å¤šæ±"], p: 2, f: ["chn", "chill"], d: "æ—©é¤åƒé€™å€‹å¤ªå¹¸ç¦" },
        { n: "è˜¿è””ç³•", k: "turnip cake", t: ["ä¸­å¼", "æ°æ°"], p: 1, f: ["chn", "rush"], d: "åŠ è›‹æ›´å¥½åƒ" },
        { n: "éµæ¿éºµ", k: "black pepper noodles", t: ["ä¸­å¼", "é‡å£å‘³"], p: 1, f: ["chn", "chill", "full"], d: "é»‘èƒ¡æ¤’åŠ è›‹" },
        { n: "é¹¹è±†æ¼¿", k: "savory soy milk", t: ["ä¸­å¼", "ç‰¹è‰²"], p: 1, f: ["chn", "chill"], d: "åƒè’¸è›‹ä¸€æ¨£çš„å£æ„Ÿ" },
        { n: "è‚‰åŒ…", k: "steamed bun", t: ["ä¸­å¼", "æ–¹ä¾¿"], p: 1, f: ["chn", "rush", "quick"], d: "ç†±é¨°é¨°çš„æ»¿è¶³æ„Ÿ" },
        { n: "è”¥æŠ“é¤…", k: "scallion pancake", t: ["ä¸­å¼", "é…¥è„†"], p: 1, f: ["chn", "rush"], d: "å±¤æ¬¡åˆ†æ˜" },
        { n: "åˆˆåŒ…", k: "gua bao", t: ["ä¸­å¼", "é£½è¶³"], p: 1, f: ["chn", "rush"], d: "æ—©é¤åƒé€™å€‹å¾ˆçˆ½" },
        { n: "ç«è…¿è›‹åå¸", k: "sandwich", t: ["è¥¿å¼", "ç¶“å…¸"], p: 1, f: ["west", "rush", "quick"], d: "åˆ‡é‚Šä¸åˆ‡é‚Šï¼Ÿ" },
        { n: "ç¸½åŒ¯ä¸‰æ˜æ²»", k: "club sandwich", t: ["è¥¿å¼", "è±å¯Œ"], p: 1, f: ["west", "rush", "full"], d: "å››å±¤å£æ„Ÿè¶…æ»¿è¶³" },
        { n: "è±¬è‚‰æ»¿ç¦å ¡", k: "mcmuffin", t: ["ç¾å¼", "ç¶“å…¸"], p: 1, f: ["west", "rush", "quick"], d: "éº¥ç•¶å‹æ—©é¤" },
        { n: "è–¯é¤…", k: "hash brown", t: ["ç¾å¼", "é…¥è„†"], p: 1, f: ["west", "quick"], d: "æ—©é¤çš„éˆé­‚" },
        { n: "è²æœ", k: "bagel cream cheese", t: ["è¥¿å¼", "åš¼å‹"], p: 1, f: ["west", "chill"], d: "æŠ¹ä¹³é…ªé†¬" },
        { n: "å¯é Œ", k: "croissant", t: ["è¥¿å¼", "é…¥è„†"], p: 1, f: ["west", "chill"], d: "é…å’–å•¡å‰›å¥½" },
        { n: "èŠ±ç”Ÿåšç‰‡", k: "toast", t: ["è¥¿å¼", "ç”œé£Ÿ"], p: 1, f: ["west", "rush", "quick"], d: "æœ‰é¡†ç²’çš„èŠ±ç”Ÿé†¬" },
        { n: "ç­å°¼è¿ªå…‹è›‹", k: "eggs benedict", t: ["æ—©åˆé¤", "ç²¾ç·»"], p: 2, f: ["west", "chill", "slow"], d: "æ°´æ³¢è›‹æ·‹ä¸Šè·è˜­é†¬" },
        { n: "ç¾å¼æ—©åˆé¤ç›¤", k: "american breakfast", t: ["æ—©åˆé¤", "è±å¯Œ"], p: 2, f: ["west", "chill", "full", "slow"], d: "ç‚’è›‹ã€åŸ¹æ ¹ã€è–¯å¡Š" },
        { n: "æ³•å¼åå¸", k: "french toast", t: ["æ—©åˆé¤", "ç”œç¾"], p: 2, f: ["west", "chill", "slow"], d: "æ·‹ä¸Šæ¥“ç³–æ¼¿" },
        { n: "æ­å§†è›‹æ²", k: "omelette", t: ["æ—©åˆé¤", "æ»‘å«©"], p: 2, f: ["west", "chill", "slow"], d: "åŒ…æ»¿è˜‘è‡èµ·å¸" },
        { n: "å„ªæ ¼ç¢—", k: "yogurt bowl", t: ["æ—©åˆé¤", "è¼•é£Ÿ"], p: 2, f: ["west", "chill", "quick"], d: "å¸Œè‡˜å„ªæ ¼é…ç‡•éº¥" },
        { n: "è¶…å•†é£¯ç³°", k: "onigiri", t: ["è¶…å•†", "æ–¹ä¾¿"], p: 1, f: ["quick", "rush"], d: "é®ªé­šã€è‚‰é¬†å£å‘³" },
        { n: "èŒ¶è‘‰è›‹", k: "tea egg", t: ["è¶…å•†", "å¥åº·"], p: 1, f: ["quick", "rush"], d: "å¥èº«æ—é¦–é¸" },
        { n: "ç‰›è‚‰æ¹¯", k: "beef soup", t: ["å°å¼", "å°å—"], p: 2, f: ["chn", "full", "slow"], d: "å°å—æ—©é¤éœ¸ä¸»" },
        { n: "æ˜Ÿå·´å…‹", k: "starbucks coffee", t: ["è¥¿å¼", "å¥¢è¯"], p: 2, f: ["west", "chill", "quick"], d: "å¯é Œé…é‚£å ¤" }
    ];

    let state = {
        mode: 'regular', 
        filters: {},
        candidates: [],
        shortlist: [],
        currentIndex: 0
    };

    // [å‚™ç”¨åˆ†é¡åœ–ç‰‡] ç•¶ç¶­åŸºç™¾ç§‘çœŸçš„æœä¸åˆ°æ™‚ï¼Œç”¨é€™äº›ï¼Œçµ•å°ä¸ç ´åœ–ï¼Œä¹Ÿä¸æœƒå…¨æ˜¯æ²™æ‹‰
    const categoryBackups = {
        'noodle': 'https://images.unsplash.com/photo-1569937745351-1fc996f05f98?auto=format&fit=crop&w=600&q=60', 
        'rice': 'https://images.unsplash.com/photo-1512058564366-18510be2db19?auto=format&fit=crop&w=600&q=60',   
        'soup': 'https://images.unsplash.com/photo-1547592166-23acbe3a624b?auto=format&fit=crop&w=600&q=60',   
        'meat': 'https://images.unsplash.com/photo-1600891964092-4316c288032e?auto=format&fit=crop&w=600&q=60',   
        'dessert': 'https://images.unsplash.com/photo-1563729768-6af584667808?auto=format&fit=crop&w=600&q=60',
        'drink': 'https://images.unsplash.com/photo-1544145945-f90425340c7e?auto=format&fit=crop&w=600&q=60',  
        'breakfast': 'https://images.unsplash.com/photo-1533089862017-54148d18ec03?auto=format&fit=crop&w=600&q=60', 
        'fastfood': 'https://images.unsplash.com/photo-1561758033-d8f3c60548dd?auto=format&fit=crop&w=600&q=60', 
        'default': 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?auto=format&fit=crop&w=600&q=60' 
    };

    // [æ ¸å¿ƒæœå°‹åŠŸèƒ½] Wiki + åˆ†é¡å‚™ç”¨
    async function searchRealImage(item) {
        // 1. å„ªå…ˆå˜—è©¦ç¶­åŸºç™¾ç§‘
        try {
            // å¦‚æœæœ‰å¼·åˆ¶é—œéµå­— k (ä¾‹å¦‚éº¥ç•¶å‹ -> Hamburger)ï¼Œå„ªå…ˆç”¨ kï¼Œå¦å‰‡ç”¨ n (åç¨±)
            const keyword = item.n; 
            const wikiUrl = `https://zh.wikipedia.org/w/api.php?action=query&format=json&prop=pageimages&titles=${keyword}&pithumbsize=500&origin=*`;
            const res = await fetch(wikiUrl);
            const data = await res.json();
            const pages = data.query.pages;
            const pageId = Object.keys(pages)[0];
            
            // æª¢æŸ¥ç¶­åŸºç™¾ç§‘æ˜¯å¦æœ‰åœ–ï¼Œä¸”ä¸æ˜¯ .svg (SVG é€šå¸¸æ˜¯åœ°åœ–æˆ– logo)
            if (pageId !== "-1" && pages[pageId].thumbnail) {
                const url = pages[pageId].thumbnail.source;
                if (!url.endsWith('.svg')) return url;
            }
        } catch (e) {
            console.log("Wiki failed, fallback...");
        }

        // 2. å¦‚æœç¶­åŸºç™¾ç§‘å¤±æ•—ï¼Œä½¿ç”¨è‹±æ–‡é—œéµå­—å» Unsplash æ‰¾ (æ›´æº–ç¢º)
        // ç‚ºäº†é¿å…å»ºç¯‰ç‰©ï¼Œæˆ‘å€‘åœ¨ DB è£¡è¨­äº† k (Keyword)
        if (item.k) {
            return `https://source.unsplash.com/600x400/?${item.k}`;
        }

        // 3. æœ€å¾Œé˜²ç·šï¼šæ ¹æ“šé—œéµå­—çµ¦åˆ†é¡åœ– (çµ•å°ä¸æœƒåªæœ‰æ²™æ‹‰)
        const name = item.n;
        const tags = item.t.join(' ');
        
        if (name.includes('éºµ') || tags.includes('éºµ')) return categoryBackups.noodle;
        if (name.includes('é£¯') || name.includes('ä¸¼') || tags.includes('é£¯')) return categoryBackups.rice;
        if (tags.includes('æœ‰æ¹¯') || tags.includes('é‹') || name.includes('æ¹¯')) return categoryBackups.soup;
        if (name.includes('æ’') || name.includes('è‚‰') || name.includes('é›')) return categoryBackups.meat;
        if (tags.includes('ç”œé»') || tags.includes('ç”œé£Ÿ') || name.includes('è±†èŠ±')) return categoryBackups.dessert;
        if (tags.includes('é€Ÿé£Ÿ') || name.includes('å ¡')) return categoryBackups.fastfood;
        if (state.mode === 'breakfast') return categoryBackups.breakfast;
        
        return categoryBackups.default;
    }

    function selectMode(mode) {
        state.mode = mode;
        document.getElementById('v-entrance').classList.remove('active');
        if (mode === 'breakfast') document.getElementById('v-bf-style').classList.add('active');
        else document.getElementById('v-hunger').classList.add('active');
    }

    function nextStep(category, value) {
        state.filters[category] = value;
        document.querySelector('.view.active').classList.remove('active');
        if (state.mode === 'regular') {
            if (category === 'hunger') document.getElementById('v-mood').classList.add('active');
            else if (category === 'mood') document.getElementById('v-budget').classList.add('active');
            else if (category === 'budget') startSwiping(dinnerDB);
        } else {
            if (category === 'style') document.getElementById('v-bf-vibe').classList.add('active');
            else if (category === 'vibe') startSwiping(breakfastDB);
        }
    }

    function startSwiping(db) {
        filterCandidates(db);
        document.getElementById('v-swipe').classList.add('active');
        document.getElementById('counter').style.display = 'block';
        renderCard();
    }

    function filterCandidates(db) {
        let list = db.filter(item => {
            let score = 0;
            if (state.mode === 'regular') {
                if (state.filters.hunger === 'light' && item.f.includes('light')) score += 2;
                if (state.filters.hunger === 'full' && item.f.includes('full')) score += 2;
                if (state.filters.hunger === 'any') score += 1;
                if (state.filters.mood === 'soup' && item.f.includes('soup')) score += 3;
                if (state.filters.mood === 'dry' && item.f.includes('dry')) score += 3;
                if (state.filters.mood === 'spicy' && item.f.includes('spicy')) score += 3;
                if (state.filters.mood === 'any') score += 1;
                if (state.filters.budget === 0 || item.p === state.filters.budget) score += 2;
                else if (Math.abs(item.p - state.filters.budget) === 1) score += 1;
            } else {
                if (state.filters.style === 'chn' && item.f.includes('chn')) score += 5;
                if (state.filters.style === 'west' && item.f.includes('west')) score += 5;
                if (state.filters.style === 'quick' && (item.f.includes('quick') || item.f.includes('rush'))) score += 5;
                if (state.filters.style === 'any') score += 1;
                if (state.filters.vibe === 'rush' && (item.f.includes('rush') || item.f.includes('quick'))) score += 3;
                if (state.filters.vibe === 'chill' && (item.f.includes('chill') || item.f.includes('slow'))) score += 3;
                if (state.filters.vibe === 'any') score += 1;
            }
            item.matchScore = score;
            return true;
        });
        list.sort((a, b) => b.matchScore - a.matchScore);
        state.candidates = shuffle(list.slice(0, 40));
        state.currentIndex = 0;
    }

    // [åœ–ç‰‡è¼‰å…¥èˆ‡æ¸²æŸ“] ç¢ºä¿æ–‡å­—æ­£ç¢ºæ¶ˆå¤±
    async function renderCard() {
        const container = document.getElementById('cardStack');
        container.innerHTML = '';
        
        if (state.currentIndex >= state.candidates.length) {
            if (state.shortlist.length > 0) showPodium();
            else container.innerHTML = '<div style="text-align:center;padding:40px;color:#999;">æ²’æœ‰ç¬¦åˆçš„é¸é …äº†...</div><div style="text-align:center;"><button class="option-btn" onclick="location.reload()">é‡ä¾†</button></div>';
            return;
        }

        const item = state.candidates[state.currentIndex];
        const card = document.createElement('div');
        card.className = 'food-card';
        
        // å»ºç«‹å¡ç‰‡çµæ§‹
        card.innerHTML = `
            <div class="card-img-wrapper" id="imgWrapper">
                <div class="loading-text" id="loadingText"><i class="fas fa-search"></i> &nbsp; è¦“é£Ÿä¸­...</div>
                <div class="card-img-layer" id="cardImgLayer"></div>
            </div>
            <div class="card-content">
                <div class="card-title">${item.n}</div>
                <div class="tags">
                    ${item.t.map(t => `<span class="tag">${t}</span>`).join('')}
                    <span class="tag" style="background:#FFF3E0;color:#F57C00">${'$'.repeat(item.p)}</span>
                </div>
                <div class="desc">${item.d}</div>
                <div class="filter-tags">
                    ${state.mode === 'regular' ? `
                        <div class="filter-chip" onclick="quickFilter('greasy')"><i class="fas fa-ban"></i> å¤ªæ²¹è†©</div>
                        <div class="filter-chip" onclick="quickFilter('spicy')"><i class="fas fa-pepper-hot"></i> ä¸åƒè¾£</div>
                        <div class="filter-chip" onclick="quickFilter('full')"><i class="fas fa-bread-slice"></i> é€™å¤ªé£½</div>
                    ` : `
                        <div class="filter-chip" onclick="quickFilter('rush')"><i class="fas fa-mug-hot"></i> æƒ³æ‚ é–’</div>
                        <div class="filter-chip" onclick="quickFilter('chn')"><i class="fas fa-hamburger"></i> æ”¹è¥¿å¼</div>
                        <div class="filter-chip" onclick="quickFilter('west')"><i class="fas fa-utensils"></i> æ”¹ä¸­å¼</div>
                    `}
                </div>
            </div>
        `;
        container.appendChild(card);

        // é–‹å§‹æ‰¾åœ–
        let imgUrl = item.cachedUrl;
        if (!imgUrl) {
            imgUrl = await searchRealImage(item);
        }
        item.finalImg = imgUrl; // å­˜èµ·ä¾†

        // åœ–ç‰‡é è¼‰å…¥é‚è¼¯ï¼šç¢ºä¿è¼‰å®Œæ‰é¡¯ç¤º
        const preloadImg = new Image();
        preloadImg.src = imgUrl;
        preloadImg.onload = () => {
            const layer = document.getElementById('cardImgLayer');
            const loader = document.getElementById('loadingText');
            if(layer && loader) {
                layer.style.backgroundImage = `url('${imgUrl}')`;
                layer.style.opacity = '1'; // æ·¡å…¥
                loader.style.opacity = '0'; // æ·¡å‡ºæ–‡å­—
                setTimeout(() => { loader.style.display = 'none'; }, 300); // ç§»é™¤ DOM
            }
        };

        // é è¼‰ä¸‹ä¸€å¼µ
        if (state.currentIndex + 1 < state.candidates.length) {
            const nextItem = state.candidates[state.currentIndex + 1];
            searchRealImage(nextItem).then(url => {
                nextItem.cachedUrl = url;
            });
        }
    }

    function handleSwipe(isLike) {
        const item = state.candidates[state.currentIndex];
        if(isLike) {
            state.shortlist.push(item);
            updateCounter();
        }
        state.currentIndex++;
        if (state.shortlist.length >= 3) showPodium();
        else renderCard();
    }

    function quickFilter(tag) {
        const card = document.querySelector('.food-card');
        if(card) {
            card.style.transition = 'transform 0.3s, opacity 0.3s';
            card.style.transform = 'translateX(-120%) rotate(-20deg)';
            card.style.opacity = '0';
        }
        setTimeout(() => {
            state.candidates = state.candidates.filter((item, index) => {
                if (index <= state.currentIndex) return true;
                return !item.f.includes(tag);
            });
            handleSwipe(false);
        }, 200);
    }

    function updateCounter() {
        document.getElementById('counter').innerText = `â¤ï¸ ${state.shortlist.length} / 3`;
    }

    function showPodium() {
        document.querySelector('.view.active').classList.remove('active');
        document.getElementById('v-swipe').style.display = 'none';
        document.getElementById('v-podium').classList.add('active');
        document.getElementById('counter').style.display = 'none';

        const list = document.getElementById('podiumList');
        list.innerHTML = '';
        
        state.shortlist.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'podium-item';
            div.id = `podium-${index}`; 
            
            div.innerHTML = `
                <div class="p-img" style="background-image: url('${item.finalImg}')"></div>
                <div class="p-info">
                    <div class="p-name">${item.n}</div>
                    <div class="p-desc">${item.d}</div>
                </div>
            `;
            list.appendChild(div);
        });
    }

    function startRoulette() {
        const btn = document.getElementById('startBtn');
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> å‘½é‹é‹è½‰ä¸­...';
        
        const items = document.querySelectorAll('.podium-item');
        const winnerIndex = Math.floor(Math.random() * state.shortlist.length);
        const totalSteps = (state.shortlist.length * 5) + winnerIndex;
        let currentStep = 0;
        let speed = 50;

        function step() {
            items.forEach(el => el.classList.remove('highlight'));
            const activeIndex = currentStep % items.length;
            items[activeIndex].classList.add('highlight');

            if (currentStep >= totalSteps) {
                setTimeout(() => {
                    showResult(state.shortlist[winnerIndex]);
                }, 500);
            } else {
                currentStep++;
                if (currentStep > totalSteps - 5) speed += 60;
                else if (currentStep > totalSteps - 15) speed += 20;
                setTimeout(step, speed);
            }
        }
        step();
    }

    function showResult(item) {
        document.querySelector('.view.active').classList.remove('active');
        document.getElementById('v-result').classList.add('active');
        
        document.getElementById('resName').innerText = item.n;
        document.getElementById('resImg').style.backgroundImage = `url('${item.finalImg}')`;
        
        document.getElementById('resTags').innerHTML = 
            item.t.map(t => `<span class="tag">${t}</span>`).join('') +
            `<span class="tag" style="background:#FFF3E0;color:#F57C00">${'$'.repeat(item.p)}</span>`;

        const query = encodeURIComponent(item.n + " é™„è¿‘");
        document.getElementById('resLink').href = `https://www.google.com/maps/search/?api=1&query=${query}`;
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }
    </script>
</body>
</html>